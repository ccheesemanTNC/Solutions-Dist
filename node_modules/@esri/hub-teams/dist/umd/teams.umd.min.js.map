{"version":3,"file":"teams.umd.min.js","sources":["../esm/types.js","../esm/well-known-teams.js","../esm/utils/has-all-privileges.js","../esm/utils/can-user-create-team-in-product.js","../esm/utils/remove-invalid-privs.js","../esm/utils/get-user-creatable-teams.js","../esm/utils/apply-priv-prop-values-to-template.js","../esm/utils/_translate-team-template.js","../../../../node_modules/tslib/tslib.es6.js","../../../../node_modules/@esri/arcgis-rest-request/dist/esm/utils/process-params.js","../../../../node_modules/@esri/arcgis-rest-request/dist/esm/utils/encode-query-string.js","../../../../node_modules/@esri/arcgis-rest-request/dist/esm/utils/ArcGISRequestError.js","../../../../node_modules/@esri/arcgis-rest-request/dist/esm/utils/warn.js","../../../../node_modules/@esri/arcgis-rest-request/dist/esm/request.js","../../../../node_modules/@esri/arcgis-rest-request/dist/esm/utils/encode-form-data.js","../../../../node_modules/@esri/arcgis-rest-request/dist/esm/utils/append-custom-params.js","../../../../node_modules/@esri/arcgis-rest-portal/dist/esm/util/get-portal-url.js","../../../../node_modules/@esri/arcgis-rest-request/dist/esm/utils/clean-url.js","../../../../node_modules/@esri/arcgis-rest-portal/dist/esm/items/update.js","../../../../node_modules/@esri/arcgis-rest-portal/dist/esm/items/helpers.js","../../../../node_modules/@esri/arcgis-rest-portal/dist/esm/util/SearchQueryBuilder.js","../../../../node_modules/@esri/arcgis-rest-portal/dist/esm/util/generic-search.js","../../../../node_modules/@esri/arcgis-rest-portal/dist/esm/util/array.js","../../../../node_modules/@esri/arcgis-rest-portal/dist/esm/groups/add-users.js","../../../../node_modules/@esri/arcgis-rest-portal/dist/esm/groups/remove-users.js","../../../../node_modules/@esri/arcgis-rest-portal/dist/esm/groups/search.js","../esm/utils/does-group-exist.js","../esm/utils/get-unique-group-title.js","../esm/utils/group-access-privs.js","../esm/utils/get-allowed-group-access.js","../esm/utils/_create-team-group.js","../../../../node_modules/@esri/arcgis-rest-portal/dist/esm/groups/create.js","../../../../node_modules/@esri/arcgis-rest-portal/dist/esm/groups/protect.js","../esm/utils/_create-team-groups.js","../esm/utils/can-user-create-team.js","../esm/utils/get-teams-available-in-product.js","../esm/utils/type-map.js","../esm/utils/get-team-by-id.js","../../../../node_modules/@esri/arcgis-rest-portal/dist/esm/groups/get.js","../esm/utils/handle-no-users.js","../esm/utils/auto-add-users-as-admins.js","../esm/utils/process-email-users.js","../esm/utils/process-auto-add-users.js","../esm/utils/process-invite-users.js","../esm/utils/add-or-invite-community-users.js","../esm/utils/add-or-invite-org-users.js","../esm/utils/add-or-invite-world-users.js","../esm/utils/add-or-invite-partnered-users.js","../esm/utils/add-or-invite-collaboration-coordinators.js","../esm/utils/group-users-by-org-relationship.js","../esm/add-or-invite-users-to-team.js","../esm/remove-users-from-team.js","../esm/utils/_search-teams.js","../esm/add-or-invite-users-to-teams.js","../esm/add-users-to-team.js","../esm/utils/can-edit-team.js","../esm/create-hub-team.js","../esm/create-hub-teams.js","../esm/utils/get-team-members.js","../esm/utils/get-team-properties-map-for-product.js","../esm/utils/get-team-status.js","../esm/utils/get-team-template.js","../esm/utils/get-team-types-available-in-product.js","../esm/utils/get-teams-for-product.js","../esm/remove-team.js","../../../../node_modules/@esri/arcgis-rest-portal/dist/esm/groups/remove.js","../esm/remove-team-from-items.js","../esm/remove-users-from-teams.js","../esm/utils/search-team-content.js","../esm/utils/search-team-members.js","../esm/utils/teams-to-add-users-to.js","../esm/update-team.js","../../../../node_modules/@esri/arcgis-rest-portal/dist/esm/groups/update.js","../esm/update-user-membership.js","../../../../node_modules/@esri/arcgis-rest-portal/dist/esm/groups/update-user-membership.js"],"sourcesContent":["/**\n * Enum of the types of teams that the teams service supports\n */\nexport var TEAMTYPES = [\n    \"core\",\n    \"content\",\n    \"followers\",\n    \"team\",\n    \"event\",\n    \"edit\",\n];\n//# sourceMappingURL=types.js.map","/**\n * Hash of the team group templates.\n * This hash is used to determin what teams can be created in what products\n * based on what privs and stored in what properties\n * We define the various groups via json structures. The .config hash controls\n * the i18n, as well as the portal vs ago, and basic vs premium definition.\n * This allows us to add/remove/edit groups by simply modifying this hash\n * instead of spreading complex construction logic all over the application\n */\nexport var WELLKNOWNTEAMS = [\n    {\n        config: {\n            groupType: \"Hub Collaboration Group\",\n            type: \"core\",\n            availableIn: [\"premium\"],\n            propertyName: \"collaborationGroupId\",\n            requiredPrivs: [\"portal:admin:createUpdateCapableGroup\"],\n            titleI18n: \"collaborationTitle\",\n            descriptionI18n: \"collaborationDesc\",\n            snippetI18n: \"collaborationSnippet\",\n            privPropValues: [\n                {\n                    priv: \"portal:user:addExternalMembersToGroup\",\n                    prop: \"membershipAccess\",\n                    value: \"collaboration\",\n                },\n            ],\n        },\n        access: \"org\",\n        autoJoin: false,\n        isInvitationOnly: false,\n        isViewOnly: false,\n        sortField: \"modified\",\n        sortOrder: \"desc\",\n        capabilities: \"updateitemcontrol\",\n        membershipAccess: \"org\",\n        _edit_privacy: \"on\",\n        _edit_contributors: \"on\",\n        tags: [\n            \"Hub Group\",\n            \"Hub Initiative Group\",\n            \"Hub Site Group\",\n            \"Hub Core Team Group\",\n            \"Hub Team Group\",\n        ],\n    },\n    {\n        config: {\n            groupType: \"Hub Collaboration Group\",\n            type: \"core\",\n            availableIn: [\"basic\"],\n            propertyName: \"collaborationGroupId\",\n            requiredPrivs: [\"portal:admin:createUpdateCapableGroup\"],\n            titleI18n: \"collaborationTitleBasic\",\n            descriptionI18n: \"collaborationDescBasic\",\n            snippetI18n: \"collaborationSnippetBasic\",\n            privPropValues: [\n                {\n                    priv: \"portal:user:addExternalMembersToGroup\",\n                    prop: \"membershipAccess\",\n                    value: \"collaboration\",\n                },\n            ],\n        },\n        access: \"org\",\n        autoJoin: false,\n        isInvitationOnly: false,\n        isViewOnly: false,\n        sortField: \"modified\",\n        sortOrder: \"desc\",\n        capabilities: \"updateitemcontrol\",\n        membershipAccess: \"org\",\n        _edit_privacy: \"on\",\n        _edit_contributors: \"on\",\n        tags: [\n            \"Hub Group\",\n            \"Hub Site Group\",\n            \"Hub Core Team Group\",\n            \"Hub Team Group\",\n        ],\n    },\n    {\n        config: {\n            groupType: \"Portal Collaboration Group\",\n            type: \"core\",\n            availableIn: [\"portal\"],\n            propertyName: \"collaborationGroupId\",\n            requiredPrivs: [\n                \"portal:user:createGroup\",\n                \"portal:admin:createUpdateCapableGroup\",\n            ],\n            titleI18n: \"collaborationTitlePortal\",\n            descriptionI18n: \"collaborationDescPortal\",\n            snippetI18n: \"collaborationSnippetPortal\",\n        },\n        access: \"org\",\n        autoJoin: false,\n        isInvitationOnly: false,\n        isViewOnly: false,\n        sortField: \"modified\",\n        sortOrder: \"desc\",\n        capabilities: \"updateitemcontrol\",\n        _edit_privacy: \"on\",\n        _edit_contributors: \"on\",\n        tags: [\"Sites Group\", \"Sites Core Team Group\"],\n    },\n    {\n        config: {\n            groupType: \"Hub Content Group\",\n            type: \"content\",\n            availableIn: [\"premium\"],\n            propertyName: \"contentGroupId\",\n            requiredPrivs: [\"portal:user:createGroup\"],\n            titleI18n: \"contentTitle\",\n            descriptionI18n: \"contentDesc\",\n            snippetI18n: \"contentSnippet\",\n            privPropValues: [\n                {\n                    priv: \"portal:user:addExternalMembersToGroup\",\n                    prop: \"membershipAccess\",\n                    value: \"\",\n                },\n            ],\n        },\n        access: \"public\",\n        autoJoin: false,\n        isInvitationOnly: false,\n        isViewOnly: false,\n        sortField: \"modified\",\n        sortOrder: \"desc\",\n        membershipAccess: \"org\",\n        tags: [\n            \"Hub Group\",\n            \"Hub Content Group\",\n            \"Hub Site Group\",\n            \"Hub Initiative Group\",\n        ],\n    },\n    {\n        config: {\n            groupType: \"Hub Content Group\",\n            type: \"content\",\n            availableIn: [\"basic\"],\n            propertyName: \"contentGroupId\",\n            requiredPrivs: [\"portal:user:createGroup\"],\n            titleI18n: \"contentTitleBasic\",\n            descriptionI18n: \"contentDescBasic\",\n            snippetI18n: \"contentSnippetBasic\",\n            privPropValues: [\n                {\n                    priv: \"portal:user:addExternalMembersToGroup\",\n                    prop: \"membershipAccess\",\n                    value: \"\",\n                },\n            ],\n        },\n        access: \"public\",\n        autoJoin: false,\n        isInvitationOnly: false,\n        isViewOnly: false,\n        sortField: \"modified\",\n        sortOrder: \"desc\",\n        membershipAccess: \"org\",\n        tags: [\"Hub Group\", \"Hub Content Group\", \"Hub Site Group\"],\n    },\n    {\n        config: {\n            groupType: \"Portal Content Group\",\n            type: \"content\",\n            availableIn: [\"portal\"],\n            propertyName: \"contentGroupId\",\n            requiredPrivs: [\"portal:user:createGroup\"],\n            titleI18n: \"contentTitle\",\n            descriptionI18n: \"contentDescPortal\",\n            snippetI18n: \"contentSnippetPortal\",\n        },\n        access: \"org\",\n        autoJoin: false,\n        isInvitationOnly: false,\n        isViewOnly: false,\n        sortField: \"modified\",\n        sortOrder: \"desc\",\n        tags: [\"Sites Group\", \"Sites Content Group\"],\n    },\n    {\n        // this is only ever created in AGO, so we don't have a second entry for followers\n        config: {\n            groupType: \"Hub Followers Group\",\n            type: \"followers\",\n            availableIn: [\"premium\"],\n            propertyName: \"followersGroupId\",\n            requiredPrivs: [\"portal:user:createGroup\"],\n            titleI18n: \"followersTitle\",\n            descriptionI18n: \"followersDesc\",\n            snippetI18n: \"followersSnippet\",\n            privPropValues: [\n                {\n                    priv: \"portal:user:addExternalMembersToGroup\",\n                    prop: \"membershipAccess\",\n                    value: \"\",\n                },\n            ],\n        },\n        access: \"public\",\n        autoJoin: true,\n        isInvitationOnly: false,\n        isViewOnly: true,\n        notificationsEnabled: true,\n        sortField: \"title\",\n        sortOrder: \"asc\",\n        membershipAccess: \"org\",\n        tags: [\n            \"Hub Group\",\n            \"Hub Initiative Followers Group\",\n            \"Hub Initiative Group\",\n        ],\n    },\n    {\n        config: {\n            groupType: \"Generic AGO Site Team\",\n            type: \"team\",\n            availableIn: [\"basic\"],\n            requiredPrivs: [\"portal:user:createGroup\"],\n            titleI18n: \"teamTitle\",\n            descriptionI18n: \"teamDesc\",\n            snippetI18n: \"teamSnippet\",\n        },\n        access: \"org\",\n        autoJoin: false,\n        isInvitationOnly: false,\n        isViewOnly: false,\n        sortField: \"modified\",\n        sortOrder: \"desc\",\n        tags: [\"Site Team Group\"],\n    },\n    {\n        config: {\n            groupType: \"Generic AGO Initiative Team\",\n            type: \"team\",\n            availableIn: [\"premium\"],\n            requiredPrivs: [\n                \"portal:user:createGroup\",\n                \"portal:user:addExternalMembersToGroup\",\n            ],\n            titleI18n: \"teamTitle\",\n            descriptionI18n: \"teamDesc\",\n            snippetI18n: \"teamSnippet\",\n        },\n        access: \"org\",\n        autoJoin: false,\n        isInvitationOnly: false,\n        isViewOnly: false,\n        sortField: \"modified\",\n        sortOrder: \"desc\",\n        membershipAccess: \"\",\n        tags: [\"Hub Team Group\"],\n    },\n    {\n        config: {\n            groupType: \"Generic AGO Edit Supporting Team\",\n            type: \"edit\",\n            availableIn: [\"premium\"],\n            requiredPrivs: [\n                \"portal:user:createGroup\",\n                \"portal:user:addExternalMembersToGroup\",\n            ],\n            titleI18n: \"teamTitle\",\n            descriptionI18n: \"editTeamDesc\",\n            snippetI18n: \"editTeamSnippet\",\n        },\n        access: \"org\",\n        autoJoin: false,\n        isInvitationOnly: false,\n        isViewOnly: false,\n        sortField: \"modified\",\n        sortOrder: \"desc\",\n        capabilities: \"updateitemcontrol\",\n        membershipAccess: \"org\",\n        tags: [\"Hub Team Group\"],\n        typekeyword: [\"Hub Team\", \"Hub Edit Supporting Team\"],\n    },\n    {\n        config: {\n            groupType: \"Generic Portal Edit Supporting Team\",\n            type: \"edit\",\n            availableIn: [\"portal\"],\n            requiredPrivs: [\"portal:user:createGroup\"],\n            titleI18n: \"teamTitle\",\n            descriptionI18n: \"editTeamDesc\",\n            snippetI18n: \"editTeamSnippet\",\n        },\n        access: \"org\",\n        autoJoin: false,\n        isInvitationOnly: false,\n        isViewOnly: false,\n        sortField: \"modified\",\n        sortOrder: \"desc\",\n        capabilities: \"updateitemcontrol\",\n        membershipAccess: \"org\",\n        tags: [\"Site Team Group\"],\n        typekeyword: [\"Site Team\", \"Site Edit Supporting Team\"],\n    },\n    {\n        config: {\n            groupType: \"Generic Portal Team\",\n            type: \"team\",\n            availableIn: [\"portal\"],\n            requiredPrivs: [\"portal:user:createGroup\"],\n            titleI18n: \"teamTitle\",\n            descriptionI18n: \"teamDesc\",\n            snippetI18n: \"teamSnippet\",\n        },\n        access: \"org\",\n        autoJoin: false,\n        isInvitationOnly: false,\n        isViewOnly: false,\n        sortField: \"modified\",\n        sortOrder: \"desc\",\n        tags: [\"Site Team Group\"],\n    },\n    {\n        config: {\n            groupType: \"Generic Event Team\",\n            type: \"event\",\n            availableIn: [\"premium\"],\n            requiredPrivs: [\n                \"portal:user:createGroup\",\n                \"portal:user:addExternalMembersToGroup\",\n            ],\n            titleI18n: \"eventTeamTitle\",\n            descriptionI18n: \"eventTeamDesc\",\n            snippetI18n: \"eventTeamSnippet\",\n        },\n        access: \"public\",\n        autoJoin: true,\n        isInvitationOnly: false,\n        isViewOnly: false,\n        sortField: \"title\",\n        sortOrder: \"asc\",\n        membershipAccess: \"\",\n        tags: [\"Hub Group\", \"Hub Event Group\", \"Hub Initiative Group\"],\n    },\n];\n//# sourceMappingURL=well-known-teams.js.map","/**\n * Does a user have all the privileges in the passed in array\n * @param {current user from session} user\n * @param {array} privileges\n */\nexport function hasAllPrivileges(user, privileges) {\n    var result = false;\n    // ensure we were passed an array...\n    if (Array.isArray(privileges)) {\n        result = privileges.every(function (priv) { return user.privileges.indexOf(priv) > -1; });\n    }\n    return result;\n}\n//# sourceMappingURL=has-all-privileges.js.map","import { hasAllPrivileges } from \"./has-all-privileges\";\nimport { getProp, includes } from \"@esri/hub-common\";\n/**\n * Predicate for filtering group templates based on product\n * and user privs required.\n * Param order is optimized for partial application\n * @param {object} user\n * @param {string} product basic, premium, portal\n * @param {object} template Team (group) template\n */\nexport function canUserCreateTeamInProduct(user, product, template) {\n    var result = false;\n    var userGroups = getProp(user, \"groups\") || [];\n    // can this be created in the current environment?\n    if (userGroups.length < 507 &&\n        includes(template.config.availableIn, product)) {\n        // and user has required privs...\n        result = hasAllPrivileges(user, template.config.requiredPrivs);\n    }\n    return result;\n}\n//# sourceMappingURL=can-user-create-team-in-product.js.map","import { cloneObject, includes, without } from \"@esri/hub-common\";\nvar ALLOWED_SUBSCRIPTION_TYPES = [\n    \"Demo & Marketing\",\n    \"Demo and Marketing\",\n    \"Organizational Plan\",\n    \"Community\",\n    \"In House\",\n    \"ConnectED\",\n    \"ELA\",\n    \"Education Site License\",\n    \"Education\",\n    \"HUP Online\",\n];\n/**\n * TODO: If/when AGO implements this logic or runs a script on their end we can remove\n * this logic, or simply return passed in user.\n * Returns a cloned copy of the user object with updated privileges\n * based on whether or not the user has a subscription type not in the\n * allowed list\n * @param {object} user\n * @param {string} subscriptionInfoType\n * @returns\n */\nexport function removeInvalidPrivs(user, subscriptionInfoType) {\n    // Clone User\n    var clonedUser = cloneObject(user);\n    // Get allowed list of sub types\n    var allowedSubscriptionTypes = ALLOWED_SUBSCRIPTION_TYPES;\n    // If portal self has a sub type OTHER than one of the allowed ones...\n    if (!includes(allowedSubscriptionTypes, subscriptionInfoType)) {\n        clonedUser.privileges = without(clonedUser.privileges, \"portal:user:addExternalMembersToGroup\");\n    }\n    return clonedUser;\n}\n//# sourceMappingURL=remove-invalid-privs.js.map","import { cloneObject } from \"@esri/hub-common\";\nimport { WELLKNOWNTEAMS } from \"../well-known-teams\";\nimport { canUserCreateTeamInProduct } from \"./can-user-create-team-in-product\";\nimport { removeInvalidPrivs } from \"./remove-invalid-privs\";\nimport { applyPrivPropValuesToTemplate } from \"./apply-priv-prop-values-to-template\";\n// TODO: Remove portalApiVersion at next breaking change\n/**\n * Return array of group templates that the current user has licensing\n * and privs to create in the current environment (AGO vs Portal)\n * @param {object} user\n * @param {string} environment\n * @param {string} portalApiVersion\n * @param {string} subscriptionInfoType\n */\nexport function getUserCreatableTeams(user, environment, portalApiVersion, // Depracated, remove at next breaking change\nsubscriptionInfoType) {\n    if (subscriptionInfoType === void 0) { subscriptionInfoType = \"\"; }\n    /* tslint:disable no-console */\n    console.warn(\"Hub.js::getUserCreatableTeams Deprecation warning portalApiVersion will be removed at v9.0.0\");\n    /* tslint:enable no-console */\n    var teams = WELLKNOWNTEAMS;\n    // Online is not properly respecting addExternalMembersToGroup for\n    // certain subscription types known ones so far: Trial, personal use, developer, and evaluation\n    var updatedUser = removeInvalidPrivs(user, subscriptionInfoType);\n    // Update templates and remove the ones that aren't applicable.\n    return cloneObject(teams).reduce(function (acc, teamTmpl) {\n        // Update template based on privPropValue\n        var copyTemplate = applyPrivPropValuesToTemplate(updatedUser, teamTmpl);\n        // If the user can create the team....\n        if (canUserCreateTeamInProduct(updatedUser, environment, copyTemplate)) {\n            // Add the team to the accumulator\n            acc.push(copyTemplate);\n        }\n        return acc;\n    }, []);\n}\n//# sourceMappingURL=get-user-creatable-teams.js.map","import { cloneObject, getWithDefault, includes } from \"@esri/hub-common\";\n/**\n * Updates template based upon new privPropValues property\n * In the templates config hash.\n * This allows us to conditionally change out parts of the template\n * @param {object} user\n * @param {object} template\n * @returns {object} Returns updated template\n */\nexport function applyPrivPropValuesToTemplate(user, template) {\n    var templateCopy = cloneObject(template);\n    // Only two templates actually have this in config atm, so we want to be safe.\n    var ppv = getWithDefault(template, \"config.privPropValues\", []);\n    // iterate over privPropValues\n    ppv.forEach(function (entry) {\n        // entry === each privPropValue obj { priv, prop, value}\n        // If user privileges includes the privilege in privPropValue...\n        if (includes(user.privileges, entry.priv)) {\n            // update the group template with appropriate prop / value changes\n            templateCopy[entry.prop] = entry.value; // for example updating the membershipAccess\n        }\n    });\n    return templateCopy;\n}\n//# sourceMappingURL=apply-priv-prop-values-to-template.js.map","import { getProp } from \"@esri/hub-common\";\n/**\n * Inject the translations into the Group object template\n * @param {object} template Json Template for the Group\n * @param {string} title Group Title\n * @param {object} translation Translation json\n * @private\n */\nexport function _translateTeamTemplate(template, title, translation) {\n    // the team template has the i18n keys in a configuration hash\n    // we iterate those properties...\n    [\"titleI18n\", \"descriptionI18n\", \"snippetI18n\"].forEach(function (key) {\n        // get the actual i18n key from the template itself\n        var i18nKey = template.config[key];\n        // compute the target property name by removing the I18n\n        var targetProp = key.replace(\"I18n\", \"\");\n        // get the translation out of the translation file we fetched\n        var val = getProp(translation, \"addons.services.teams.groups.\" + i18nKey);\n        // interpolate the title name into the translation string\n        template[targetProp] = val.replace(/{title}/g, title);\n    });\n    return template;\n}\n//# sourceMappingURL=_translate-team-template.js.map","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __createBinding(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (p !== \"default\" && !exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","/* Copyright (c) 2017 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\n/**\n * Checks parameters to see if we should use FormData to send the request\n * @param params The object whose keys will be encoded.\n * @return A boolean indicating if FormData will be required.\n */\nexport function requiresFormData(params) {\n    return Object.keys(params).some(function (key) {\n        var value = params[key];\n        if (!value) {\n            return false;\n        }\n        if (value && value.toParam) {\n            value = value.toParam();\n        }\n        var type = value.constructor.name;\n        switch (type) {\n            case \"Array\":\n                return false;\n            case \"Object\":\n                return false;\n            case \"Date\":\n                return false;\n            case \"Function\":\n                return false;\n            case \"Boolean\":\n                return false;\n            case \"String\":\n                return false;\n            case \"Number\":\n                return false;\n            default:\n                return true;\n        }\n    });\n}\n/**\n * Converts parameters to the proper representation to send to the ArcGIS REST API.\n * @param params The object whose keys will be encoded.\n * @return A new object with properly encoded values.\n */\nexport function processParams(params) {\n    var newParams = {};\n    Object.keys(params).forEach(function (key) {\n        var _a, _b;\n        var param = params[key];\n        if (param && param.toParam) {\n            param = param.toParam();\n        }\n        if (!param &&\n            param !== 0 &&\n            typeof param !== \"boolean\" &&\n            typeof param !== \"string\") {\n            return;\n        }\n        var type = param.constructor.name;\n        var value;\n        // properly encodes objects, arrays and dates for arcgis.com and other services.\n        // ported from https://github.com/Esri/esri-leaflet/blob/master/src/Request.js#L22-L30\n        // also see https://github.com/Esri/arcgis-rest-js/issues/18:\n        // null, undefined, function are excluded. If you want to send an empty key you need to send an empty string \"\".\n        switch (type) {\n            case \"Array\":\n                // Based on the first element of the array, classify array as an array of arrays, an array of objects\n                // to be stringified, or an array of non-objects to be comma-separated\n                // eslint-disable-next-line no-case-declarations\n                var firstElementType = (_b = (_a = param[0]) === null || _a === void 0 ? void 0 : _a.constructor) === null || _b === void 0 ? void 0 : _b.name;\n                value =\n                    firstElementType === \"Array\" ? param : // pass thru array of arrays\n                        firstElementType === \"Object\" ? JSON.stringify(param) : // stringify array of objects\n                            param.join(\",\"); // join other types of array elements\n                break;\n            case \"Object\":\n                value = JSON.stringify(param);\n                break;\n            case \"Date\":\n                value = param.valueOf();\n                break;\n            case \"Function\":\n                value = null;\n                break;\n            case \"Boolean\":\n                value = param + \"\";\n                break;\n            default:\n                value = param;\n                break;\n        }\n        if (value || value === 0 || typeof value === \"string\" || Array.isArray(value)) {\n            newParams[key] = value;\n        }\n    });\n    return newParams;\n}\n//# sourceMappingURL=process-params.js.map","/* Copyright (c) 2017 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\nimport { processParams } from \"./process-params\";\n/**\n * Encodes keys and parameters for use in a URL's query string.\n *\n * @param key Parameter's key\n * @param value Parameter's value\n * @returns Query string with key and value pairs separated by \"&\"\n */\nexport function encodeParam(key, value) {\n    // For array of arrays, repeat key=value for each element of containing array\n    if (Array.isArray(value) && value[0] && Array.isArray(value[0])) {\n        return value.map(function (arrayElem) { return encodeParam(key, arrayElem); }).join(\"&\");\n    }\n    return encodeURIComponent(key) + \"=\" + encodeURIComponent(value);\n}\n/**\n * Encodes the passed object as a query string.\n *\n * @param params An object to be encoded.\n * @returns An encoded query string.\n */\nexport function encodeQueryString(params) {\n    var newParams = processParams(params);\n    return Object.keys(newParams)\n        .map(function (key) {\n        return encodeParam(key, newParams[key]);\n    })\n        .join(\"&\");\n}\n//# sourceMappingURL=encode-query-string.js.map","/* Copyright (c) 2017 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\n// TypeScript 2.1 no longer allows you to extend built in types. See https://github.com/Microsoft/TypeScript/issues/12790#issuecomment-265981442\n// and https://github.com/Microsoft/TypeScript-wiki/blob/master/Breaking-Changes.md#extending-built-ins-like-error-array-and-map-may-no-longer-work\n//\n// This code is from MDN https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error#Custom_Error_Types.\nvar ArcGISRequestError = /** @class */ (function () {\n    /**\n     * Create a new `ArcGISRequestError`  object.\n     *\n     * @param message - The error message from the API\n     * @param code - The error code from the API\n     * @param response - The original response from the API that caused the error\n     * @param url - The original url of the request\n     * @param options - The original options and parameters of the request\n     */\n    function ArcGISRequestError(message, code, response, url, options) {\n        message = message || \"UNKNOWN_ERROR\";\n        code = code || \"UNKNOWN_ERROR_CODE\";\n        this.name = \"ArcGISRequestError\";\n        this.message =\n            code === \"UNKNOWN_ERROR_CODE\" ? message : code + \": \" + message;\n        this.originalMessage = message;\n        this.code = code;\n        this.response = response;\n        this.url = url;\n        this.options = options;\n    }\n    return ArcGISRequestError;\n}());\nexport { ArcGISRequestError };\nArcGISRequestError.prototype = Object.create(Error.prototype);\nArcGISRequestError.prototype.constructor = ArcGISRequestError;\n//# sourceMappingURL=ArcGISRequestError.js.map","/* Copyright (c) 2017-2018 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\n/**\n * Method used internally to surface messages to developers.\n */\nexport function warn(message) {\n    if (console && console.warn) {\n        console.warn.apply(console, [message]);\n    }\n}\n//# sourceMappingURL=warn.js.map","/* Copyright (c) 2017-2018 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\nimport { __assign, __extends } from \"tslib\";\nimport { encodeFormData } from \"./utils/encode-form-data\";\nimport { encodeQueryString } from \"./utils/encode-query-string\";\nimport { requiresFormData } from \"./utils/process-params\";\nimport { ArcGISRequestError } from \"./utils/ArcGISRequestError\";\nimport { warn } from \"./utils/warn\";\nexport var NODEJS_DEFAULT_REFERER_HEADER = \"@esri/arcgis-rest-js\";\nvar DEFAULT_ARCGIS_REQUEST_OPTIONS = {\n    httpMethod: \"POST\",\n    params: {\n        f: \"json\",\n    },\n};\n/**\n * Sets the default options that will be passed in **all requests across all `@esri/arcgis-rest-js` modules**.\n *\n *\n * ```js\n * import { setDefaultRequestOptions } from \"@esri/arcgis-rest-request\";\n * setDefaultRequestOptions({\n *   authentication: userSession // all requests will use this session by default\n * })\n * ```\n * You should **never** set a default `authentication` when you are in a server side environment where you may be handling requests for many different authenticated users.\n *\n * @param options The default options to pass with every request. Existing default will be overwritten.\n * @param hideWarnings Silence warnings about setting default `authentication` in shared environments.\n */\nexport function setDefaultRequestOptions(options, hideWarnings) {\n    if (options.authentication && !hideWarnings) {\n        warn(\"You should not set `authentication` as a default in a shared environment such as a web server which will process multiple users requests. You can call `setDefaultRequestOptions` with `true` as a second argument to disable this warning.\");\n    }\n    DEFAULT_ARCGIS_REQUEST_OPTIONS = options;\n}\nvar ArcGISAuthError = /** @class */ (function (_super) {\n    __extends(ArcGISAuthError, _super);\n    /**\n     * Create a new `ArcGISAuthError`  object.\n     *\n     * @param message - The error message from the API\n     * @param code - The error code from the API\n     * @param response - The original response from the API that caused the error\n     * @param url - The original url of the request\n     * @param options - The original options of the request\n     */\n    function ArcGISAuthError(message, code, response, url, options) {\n        if (message === void 0) { message = \"AUTHENTICATION_ERROR\"; }\n        if (code === void 0) { code = \"AUTHENTICATION_ERROR_CODE\"; }\n        var _this = _super.call(this, message, code, response, url, options) || this;\n        _this.name = \"ArcGISAuthError\";\n        _this.message =\n            code === \"AUTHENTICATION_ERROR_CODE\" ? message : code + \": \" + message;\n        return _this;\n    }\n    ArcGISAuthError.prototype.retry = function (getSession, retryLimit) {\n        var _this = this;\n        if (retryLimit === void 0) { retryLimit = 3; }\n        var tries = 0;\n        var retryRequest = function (resolve, reject) {\n            getSession(_this.url, _this.options)\n                .then(function (session) {\n                var newOptions = __assign(__assign({}, _this.options), { authentication: session });\n                tries = tries + 1;\n                return request(_this.url, newOptions);\n            })\n                .then(function (response) {\n                resolve(response);\n            })\n                .catch(function (e) {\n                if (e.name === \"ArcGISAuthError\" && tries < retryLimit) {\n                    retryRequest(resolve, reject);\n                }\n                else if (e.name === \"ArcGISAuthError\" && tries >= retryLimit) {\n                    reject(_this);\n                }\n                else {\n                    reject(e);\n                }\n            });\n        };\n        return new Promise(function (resolve, reject) {\n            retryRequest(resolve, reject);\n        });\n    };\n    return ArcGISAuthError;\n}(ArcGISRequestError));\nexport { ArcGISAuthError };\n/**\n * Checks for errors in a JSON response from the ArcGIS REST API. If there are no errors, it will return the `data` passed in. If there is an error, it will throw an `ArcGISRequestError` or `ArcGISAuthError`.\n *\n * @param data The response JSON to check for errors.\n * @param url The url of the original request\n * @param params The parameters of the original request\n * @param options The options of the original request\n * @returns The data that was passed in the `data` parameter\n */\nexport function checkForErrors(response, url, params, options, originalAuthError) {\n    // this is an error message from billing.arcgis.com backend\n    if (response.code >= 400) {\n        var message = response.message, code = response.code;\n        throw new ArcGISRequestError(message, code, response, url, options);\n    }\n    // error from ArcGIS Online or an ArcGIS Portal or server instance.\n    if (response.error) {\n        var _a = response.error, message = _a.message, code = _a.code, messageCode = _a.messageCode;\n        var errorCode = messageCode || code || \"UNKNOWN_ERROR_CODE\";\n        if (code === 498 ||\n            code === 499 ||\n            messageCode === \"GWM_0003\" ||\n            (code === 400 && message === \"Unable to generate token.\")) {\n            if (originalAuthError) {\n                throw originalAuthError;\n            }\n            else {\n                throw new ArcGISAuthError(message, errorCode, response, url, options);\n            }\n        }\n        throw new ArcGISRequestError(message, errorCode, response, url, options);\n    }\n    // error from a status check\n    if (response.status === \"failed\" || response.status === \"failure\") {\n        var message = void 0;\n        var code = \"UNKNOWN_ERROR_CODE\";\n        try {\n            message = JSON.parse(response.statusMessage).message;\n            code = JSON.parse(response.statusMessage).code;\n        }\n        catch (e) {\n            message = response.statusMessage || response.message;\n        }\n        throw new ArcGISRequestError(message, code, response, url, options);\n    }\n    return response;\n}\n/**\n * ```js\n * import { request } from '@esri/arcgis-rest-request';\n * //\n * request('https://www.arcgis.com/sharing/rest')\n *   .then(response) // response.currentVersion === 5.2\n * //\n * request('https://www.arcgis.com/sharing/rest', {\n *   httpMethod: \"GET\"\n * })\n * //\n * request('https://www.arcgis.com/sharing/rest/search', {\n *   params: { q: 'parks' }\n * })\n *   .then(response) // response.total => 78379\n * ```\n * Generic method for making HTTP requests to ArcGIS REST API endpoints.\n *\n * @param url - The URL of the ArcGIS REST API endpoint.\n * @param requestOptions - Options for the request, including parameters relevant to the endpoint.\n * @returns A Promise that will resolve with the data from the response.\n */\nexport function request(url, requestOptions) {\n    if (requestOptions === void 0) { requestOptions = { params: { f: \"json\" } }; }\n    var options = __assign(__assign(__assign({ httpMethod: \"POST\" }, DEFAULT_ARCGIS_REQUEST_OPTIONS), requestOptions), {\n        params: __assign(__assign({}, DEFAULT_ARCGIS_REQUEST_OPTIONS.params), requestOptions.params),\n        headers: __assign(__assign({}, DEFAULT_ARCGIS_REQUEST_OPTIONS.headers), requestOptions.headers),\n    });\n    var missingGlobals = [];\n    var recommendedPackages = [];\n    // don't check for a global fetch if a custom implementation was passed through\n    if (!options.fetch && typeof fetch !== \"undefined\") {\n        options.fetch = fetch.bind(Function(\"return this\")());\n    }\n    else {\n        missingGlobals.push(\"`fetch`\");\n        recommendedPackages.push(\"`node-fetch`\");\n    }\n    if (typeof Promise === \"undefined\") {\n        missingGlobals.push(\"`Promise`\");\n        recommendedPackages.push(\"`es6-promise`\");\n    }\n    if (typeof FormData === \"undefined\") {\n        missingGlobals.push(\"`FormData`\");\n        recommendedPackages.push(\"`isomorphic-form-data`\");\n    }\n    if (!options.fetch ||\n        typeof Promise === \"undefined\" ||\n        typeof FormData === \"undefined\") {\n        throw new Error(\"`arcgis-rest-request` requires a `fetch` implementation and global variables for `Promise` and `FormData` to be present in the global scope. You are missing \" + missingGlobals.join(\", \") + \". We recommend installing the \" + recommendedPackages.join(\", \") + \" modules at the root of your application to add these to the global scope. See https://bit.ly/2KNwWaJ for more info.\");\n    }\n    var httpMethod = options.httpMethod, authentication = options.authentication, rawResponse = options.rawResponse;\n    var params = __assign({ f: \"json\" }, options.params);\n    var originalAuthError = null;\n    var fetchOptions = {\n        method: httpMethod,\n        /* ensures behavior mimics XMLHttpRequest.\n        needed to support sending IWA cookies */\n        credentials: options.credentials || \"same-origin\",\n    };\n    // the /oauth2/platformSelf route will add X-Esri-Auth-Client-Id header\n    // and that request needs to send cookies cross domain\n    // so we need to set the credentials to \"include\"\n    if (options.headers &&\n        options.headers[\"X-Esri-Auth-Client-Id\"] &&\n        url.indexOf(\"/oauth2/platformSelf\") > -1) {\n        fetchOptions.credentials = \"include\";\n    }\n    return (authentication\n        ? authentication.getToken(url, { fetch: options.fetch }).catch(function (err) {\n            /**\n             * append original request url and requestOptions\n             * to the error thrown by getToken()\n             * to assist with retrying\n             */\n            err.url = url;\n            err.options = options;\n            /**\n             * if an attempt is made to talk to an unfederated server\n             * first try the request anonymously. if a 'token required'\n             * error is thrown, throw the UNFEDERATED error then.\n             */\n            originalAuthError = err;\n            return Promise.resolve(\"\");\n        })\n        : Promise.resolve(\"\"))\n        .then(function (token) {\n        if (token.length) {\n            params.token = token;\n        }\n        if (authentication && authentication.getDomainCredentials) {\n            fetchOptions.credentials = authentication.getDomainCredentials(url);\n        }\n        // Custom headers to add to request. IRequestOptions.headers with merge over requestHeaders.\n        var requestHeaders = {};\n        if (fetchOptions.method === \"GET\") {\n            // Prevents token from being passed in query params when hideToken option is used.\n            /* istanbul ignore if - window is always defined in a browser. Test case is covered by Jasmine in node test */\n            if (params.token &&\n                options.hideToken &&\n                // Sharing API does not support preflight check required by modern browsers https://developer.mozilla.org/en-US/docs/Glossary/Preflight_request\n                typeof window === \"undefined\") {\n                requestHeaders[\"X-Esri-Authorization\"] = \"Bearer \" + params.token;\n                delete params.token;\n            }\n            // encode the parameters into the query string\n            var queryParams = encodeQueryString(params);\n            // dont append a '?' unless parameters are actually present\n            var urlWithQueryString = queryParams === \"\" ? url : url + \"?\" + encodeQueryString(params);\n            if (\n            // This would exceed the maximum length for URLs specified by the consumer and requires POST\n            (options.maxUrlLength &&\n                urlWithQueryString.length > options.maxUrlLength) ||\n                // Or if the customer requires the token to be hidden and it has not already been hidden in the header (for browsers)\n                (params.token && options.hideToken)) {\n                // the consumer specified a maximum length for URLs\n                // and this would exceed it, so use post instead\n                fetchOptions.method = \"POST\";\n                // If the token was already added as a Auth header, add the token back to body with other params instead of header\n                if (token.length && options.hideToken) {\n                    params.token = token;\n                    // Remove existing header that was added before url query length was checked\n                    delete requestHeaders[\"X-Esri-Authorization\"];\n                }\n            }\n            else {\n                // just use GET\n                url = urlWithQueryString;\n            }\n        }\n        /* updateResources currently requires FormData even when the input parameters dont warrant it.\n    https://developers.arcgis.com/rest/users-groups-and-items/update-resources.htm\n        see https://github.com/Esri/arcgis-rest-js/pull/500 for more info. */\n        var forceFormData = new RegExp(\"/items/.+/updateResources\").test(url);\n        if (fetchOptions.method === \"POST\") {\n            fetchOptions.body = encodeFormData(params, forceFormData);\n        }\n        // Mixin headers from request options\n        fetchOptions.headers = __assign(__assign({}, requestHeaders), options.headers);\n        /* istanbul ignore next - karma reports coverage on browser tests only */\n        if (typeof window === \"undefined\" && !fetchOptions.headers.referer) {\n            fetchOptions.headers.referer = NODEJS_DEFAULT_REFERER_HEADER;\n        }\n        /* istanbul ignore else blob responses are difficult to make cross platform we will just have to trust the isomorphic fetch will do its job */\n        if (!requiresFormData(params) && !forceFormData) {\n            fetchOptions.headers[\"Content-Type\"] =\n                \"application/x-www-form-urlencoded\";\n        }\n        return options.fetch(url, fetchOptions);\n    })\n        .then(function (response) {\n        if (!response.ok) {\n            // server responded w/ an actual error (404, 500, etc)\n            var status_1 = response.status, statusText = response.statusText;\n            throw new ArcGISRequestError(statusText, \"HTTP \" + status_1, response, url, options);\n        }\n        if (rawResponse) {\n            return response;\n        }\n        switch (params.f) {\n            case \"json\":\n                return response.json();\n            case \"geojson\":\n                return response.json();\n            case \"html\":\n                return response.text();\n            case \"text\":\n                return response.text();\n            /* istanbul ignore next blob responses are difficult to make cross platform we will just have to trust that isomorphic fetch will do its job */\n            default:\n                return response.blob();\n        }\n    })\n        .then(function (data) {\n        if ((params.f === \"json\" || params.f === \"geojson\") && !rawResponse) {\n            var response = checkForErrors(data, url, params, options, originalAuthError);\n            if (originalAuthError) {\n                /* If the request was made to an unfederated service that\n                didn't require authentication, add the base url and a dummy token\n                to the list of trusted servers to avoid another federation check\n                in the event of a repeat request */\n                var truncatedUrl = url\n                    .toLowerCase()\n                    .split(/\\/rest(\\/admin)?\\/services\\//)[0];\n                options.authentication.federatedServers[truncatedUrl] = {\n                    token: [],\n                    // default to 24 hours\n                    expires: new Date(Date.now() + 86400 * 1000),\n                };\n                originalAuthError = null;\n            }\n            return response;\n        }\n        else {\n            return data;\n        }\n    });\n}\n//# sourceMappingURL=request.js.map","/* Copyright (c) 2017 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\nimport { processParams, requiresFormData } from \"./process-params\";\nimport { encodeQueryString } from \"./encode-query-string\";\n/**\n * Encodes parameters in a [FormData](https://developer.mozilla.org/en-US/docs/Web/API/FormData) object in browsers or in a [FormData](https://github.com/form-data/form-data) in Node.js\n *\n * @param params An object to be encoded.\n * @returns The complete [FormData](https://developer.mozilla.org/en-US/docs/Web/API/FormData) object.\n */\nexport function encodeFormData(params, forceFormData) {\n    // see https://github.com/Esri/arcgis-rest-js/issues/499 for more info.\n    var useFormData = requiresFormData(params) || forceFormData;\n    var newParams = processParams(params);\n    if (useFormData) {\n        var formData_1 = new FormData();\n        Object.keys(newParams).forEach(function (key) {\n            if (typeof Blob !== \"undefined\" && newParams[key] instanceof Blob) {\n                /* To name the Blob:\n                 1. look to an alternate request parameter called 'fileName'\n                 2. see if 'name' has been tacked onto the Blob manually\n                 3. if all else fails, use the request parameter\n                */\n                var filename = newParams[\"fileName\"] || newParams[key].name || key;\n                formData_1.append(key, newParams[key], filename);\n            }\n            else {\n                formData_1.append(key, newParams[key]);\n            }\n        });\n        return formData_1;\n    }\n    else {\n        return encodeQueryString(params);\n    }\n}\n//# sourceMappingURL=encode-form-data.js.map","/* Copyright (c) 2017-2018 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\nimport { __assign } from \"tslib\";\n/**\n * Helper for methods with lots of first order request options to pass through as request parameters.\n */\nexport function appendCustomParams(customOptions, keys, baseOptions) {\n    var requestOptionsKeys = [\n        \"params\",\n        \"httpMethod\",\n        \"rawResponse\",\n        \"authentication\",\n        \"portal\",\n        \"fetch\",\n        \"maxUrlLength\",\n        \"headers\"\n    ];\n    var options = __assign(__assign({ params: {} }, baseOptions), customOptions);\n    // merge all keys in customOptions into options.params\n    options.params = keys.reduce(function (value, key) {\n        if (customOptions[key] || typeof customOptions[key] === \"boolean\") {\n            value[key] = customOptions[key];\n        }\n        return value;\n    }, options.params);\n    // now remove all properties in options that don't exist in IRequestOptions\n    return requestOptionsKeys.reduce(function (value, key) {\n        if (options[key]) {\n            value[key] = options[key];\n        }\n        return value;\n    }, {});\n}\n//# sourceMappingURL=append-custom-params.js.map","/* Copyright (c) 2017 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\nimport { cleanUrl } from \"@esri/arcgis-rest-request\";\n/**\n * Helper that returns the appropriate portal url for a given request. `requestOptions.portal` is given\n * precedence over `authentication.portal`. If neither `portal` nor `authentication` is present,\n * `www.arcgis.com/sharing/rest` is returned.\n *\n * @param requestOptions - Request options that may have authentication manager\n * @returns Portal url to be used in API requests\n */\nexport function getPortalUrl(requestOptions) {\n    if (requestOptions === void 0) { requestOptions = {}; }\n    // use portal in options if specified\n    if (requestOptions.portal) {\n        return cleanUrl(requestOptions.portal);\n    }\n    // if auth was passed, use that portal\n    if (requestOptions.authentication) {\n        // the portal url is already scrubbed in the auth package\n        return requestOptions.authentication.portal;\n    }\n    // default to arcgis.com\n    return \"https://www.arcgis.com/sharing/rest\";\n}\n//# sourceMappingURL=get-portal-url.js.map","/* Copyright (c) 2018 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\n/**\n * Helper method to ensure that user supplied urls don't include whitespace or a trailing slash.\n */\nexport function cleanUrl(url) {\n    // Guard so we don't try to trim something that's not a string\n    if (typeof url !== \"string\") {\n        return url;\n    }\n    // trim leading and trailing spaces, but not spaces inside the url\n    url = url.trim();\n    // remove the trailing slash to the url if one was included\n    if (url[url.length - 1] === \"/\") {\n        url = url.slice(0, -1);\n    }\n    return url;\n}\n//# sourceMappingURL=clean-url.js.map","/* Copyright (c) 2018 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\nimport { __assign } from \"tslib\";\nimport { request } from \"@esri/arcgis-rest-request\";\nimport { getPortalUrl } from \"../util/get-portal-url\";\nimport { serializeItem, determineOwner } from \"./helpers\";\n/**\n * ```js\n * import { updateItem } from \"@esri/arcgis-rest-portal\";\n * //\n * updateItem({\n *   item: {\n *     id: \"3ef\",\n *     description: \"A three hour tour\"\n *   },\n *   authentication\n * })\n *   .then(response)\n * ```\n * Update an Item. See the [REST Documentation](https://developers.arcgis.com/rest/users-groups-and-items/update-item.htm) for more information.\n *\n * @param requestOptions - Options for the request.\n * @returns A Promise that updates an item.\n */\nexport function updateItem(requestOptions) {\n    return determineOwner(requestOptions).then(function (owner) {\n        var url = requestOptions.folderId\n            ? getPortalUrl(requestOptions) + \"/content/users/\" + owner + \"/\" + requestOptions.folderId + \"/items/\" + requestOptions.item.id + \"/update\"\n            : getPortalUrl(requestOptions) + \"/content/users/\" + owner + \"/items/\" + requestOptions.item.id + \"/update\";\n        // serialize the item into something Portal will accept\n        requestOptions.params = __assign(__assign({}, requestOptions.params), serializeItem(requestOptions.item));\n        return request(url, requestOptions);\n    });\n}\n/**\n * ```js\n * import { updateItemInfo } from \"@esri/arcgis-rest-portal\";\n * //\n * updateItemInfo({\n *   id: '3ef',\n *   file: file,\n *   authentication\n * })\n *   .then(response)\n * ```\n * Update an info file associated with an item. See the [REST Documentation](https://developers.arcgis.com/rest/users-groups-and-items/update-info.htm) for more information.\n *\n * @param requestOptions - Options for the request\n * @returns A Promise that updates an item info file.\n */\nexport function updateItemInfo(requestOptions) {\n    return determineOwner(requestOptions).then(function (owner) {\n        var url = getPortalUrl(requestOptions) + \"/content/users/\" + owner + \"/items/\" + requestOptions.id + \"/updateinfo\";\n        // mix in user supplied params\n        requestOptions.params = __assign({ folderName: requestOptions.folderName, file: requestOptions.file }, requestOptions.params);\n        return request(url, requestOptions);\n    });\n}\n/**\n * ```js\n * import { updateItemResource } from \"@esri/arcgis-rest-portal\";\n * //\n * updateItemResource({\n *   id: '3ef',\n *   resource: file,\n *   name: 'bigkahuna.jpg',\n *   authentication\n * })\n *   .then(response)\n * ```\n * Update a resource associated with an item. See the [REST Documentation](https://developers.arcgis.com/rest/users-groups-and-items/update-resources.htm) for more information.\n *\n * @param requestOptions - Options for the request\n * @returns A Promise that updates an item resource.\n */\nexport function updateItemResource(requestOptions) {\n    return determineOwner(requestOptions).then(function (owner) {\n        var url = getPortalUrl(requestOptions) + \"/content/users/\" + owner + \"/items/\" + requestOptions.id + \"/updateResources\";\n        // mix in user supplied params\n        requestOptions.params = __assign({ file: requestOptions.resource, fileName: requestOptions.name, resourcesPrefix: requestOptions.prefix, text: requestOptions.content }, requestOptions.params);\n        // only override the access specified previously if 'private' is passed explicitly\n        if (typeof requestOptions.private !== \"undefined\") {\n            requestOptions.params.access = requestOptions.private\n                ? \"private\"\n                : \"inherit\";\n        }\n        return request(url, requestOptions);\n    });\n}\n/**\n * ```js\n * import { moveItem } from \"@esri/arcgis-rest-portal\";\n * //\n * moveItem({\n *   itemId: \"3ef\",\n *   folderId: \"7c5\",\n *   authentication: userSession\n * })\n * ```\n * Move an item to a folder. See the [REST Documentation](https://developers.arcgis.com/rest/users-groups-and-items/move-item.htm) for more information.\n *\n * @param requestOptions - Options for the request\n * @returns A Promise that resolves with owner and folder details once the move has been completed\n */\nexport function moveItem(requestOptions) {\n    return determineOwner(requestOptions).then(function (owner) {\n        var url = getPortalUrl(requestOptions) + \"/content/users/\" + owner + \"/items/\" + requestOptions.itemId + \"/move\";\n        var folderId = requestOptions.folderId;\n        if (!folderId) {\n            folderId = \"/\";\n        }\n        requestOptions.params = __assign({ folder: folderId }, requestOptions.params);\n        return request(url, requestOptions);\n    });\n}\n//# sourceMappingURL=update.js.map","/* Copyright (c) 2017-2018 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\n/**\n * Serialize an item and its data into a json format accepted by the Portal API for create and update operations\n *\n * @param item Item to be serialized\n * @returns a formatted json object to be sent to Portal\n */\nexport function serializeItem(item) {\n    // create a clone so we're not messing with the original\n    var clone = JSON.parse(JSON.stringify(item));\n    // binary data needs POSTed as a `file`\n    // JSON object literals should be passed as `text`.\n    if (clone.data) {\n        (typeof Blob !== \"undefined\" && item.data instanceof Blob) ||\n            // Node.js doesn't implement Blob\n            item.data.constructor.name === \"ReadStream\"\n            ? (clone.file = item.data)\n            : (clone.text = item.data);\n        delete clone.data;\n    }\n    return clone;\n}\n/**\n * `requestOptions.owner` is given priority, `requestOptions.item.owner` will be checked next. If neither are present, `authentication.getUserName()` will be used instead.\n */\nexport function determineOwner(requestOptions) {\n    if (requestOptions.owner) {\n        return Promise.resolve(requestOptions.owner);\n    }\n    else if (requestOptions.item && requestOptions.item.owner) {\n        return Promise.resolve(requestOptions.item.owner);\n    }\n    else if (requestOptions.authentication &&\n        requestOptions.authentication.getUsername) {\n        return requestOptions.authentication.getUsername();\n    }\n    else {\n        return Promise.reject(new Error(\"Could not determine the owner of this item. Pass the `owner`, `item.owner`, or `authentication` option.\"));\n    }\n}\n//# sourceMappingURL=helpers.js.map","/* Copyright (c) 2018-2021 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\nimport { warn } from \"@esri/arcgis-rest-request\";\n/**\n * `SearchQueryBuilder` can be used to construct the `q` param for\n * [`searchItems`](/arcgis-rest-js/api/portal/searchItems#searchItems-search) or\n * [`searchGroups`](/arcgis-rest-js/api/portal/searchGroups#searchGroups-search).\n * By chaining methods, it helps build complex search queries.\n *\n * ```js\n * const startDate = new Date(\"2020-01-01\");\n * const endDate = new Date(\"2020-09-01\");\n * const query = new SearchQueryBuilder()\n *  .match(\"Patrick\")\n *  .in(\"owner\")\n *  .and()\n *  .from(startDate)\n *  .to(endDate)\n *  .in(\"created\")\n *  .and()\n *  .startGroup()\n *    .match(\"Web Mapping Application\")\n *    .in(\"type\")\n *    .or()\n *    .match(\"Mobile Application\")\n *    .in(\"type\")\n *    .or()\n *    .match(\"Application\")\n *    .in(\"type\")\n *  .endGroup()\n *  .and()\n *  .match(\"Demo App\");\n *\n * searchItems(query).then((res) => {\n *   console.log(res.results);\n * });\n * ```\n *\n * Will search for items matching\n * ```\n * \"owner: Patrick AND created:[1577836800000 TO 1598918400000] AND (type:\"Web Mapping Application\" OR type:\"Mobile Application\" OR type:Application) AND Demo App\"\n * ```\n */\nvar SearchQueryBuilder = /** @class */ (function () {\n    /**\n     * @param q An existing query string to start building from.\n     */\n    function SearchQueryBuilder(q) {\n        if (q === void 0) { q = \"\"; }\n        this.termStack = [];\n        this.rangeStack = [];\n        this.openGroups = 0;\n        this.q = q;\n    }\n    /**\n     * Defines strings to search for.\n     *\n     * ```js\n     * const query = new SearchQueryBuilder()\n     *   .match(\"My Layer\")\n     * ```\n     *\n     * @param terms strings to search for.\n     */\n    SearchQueryBuilder.prototype.match = function () {\n        var terms = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            terms[_i] = arguments[_i];\n        }\n        this.termStack = this.termStack.concat(terms);\n        return this;\n    };\n    /**\n     * Defines fields to search in. You can pass `\"*\"` or call this method without arguments to search a default set of fields\n     *\n     * ```js\n     * const query = new SearchQueryBuilder()\n     *   .match(\"My Layer\")\n     *   .in(\"title\")\n     * ```\n     *\n     * @param field The field to search for the previous match in.\n     */\n    SearchQueryBuilder.prototype.in = function (field) {\n        var fn = \"`in(\" + (field ? \"\\\"\" + field + \"\\\"\" : \"\") + \")`\";\n        if (!this.hasRange && !this.hasTerms) {\n            warn(\n            // apparently-p-rettier-ignore causes some\n            fn + \" was called with no call to `match(...)` or `from(...)`/`to(...)`. Your query was not modified.\");\n            return this;\n        }\n        if (field && field !== \"*\") {\n            this.q += field + \":\";\n        }\n        return this.commit();\n    };\n    /**\n     * Starts a new search group.\n     *\n     * ```js\n     * const query = new SearchQueryBuilder()\n     *   .startGroup()\n     *     .match(\"Lakes\")\n     *     .in(\"title\")\n     *   .endGroup()\n     *   .or()\n     *   .startGroup()\n     *     .match(\"Rivers\")\n     *     .in(\"title\")\n     *   .endGroup()\n     * ```\n     */\n    SearchQueryBuilder.prototype.startGroup = function () {\n        this.commit();\n        if (this.openGroups > 0) {\n            this.q += \" \";\n        }\n        this.openGroups++;\n        this.q += \"(\";\n        return this;\n    };\n    /**\n     * Ends a search group.\n     *\n     * ```js\n     * const query = new SearchQueryBuilder()\n     *   .startGroup()\n     *     .match(\"Lakes\")\n     *     .in(\"title\")\n     *   .endGroup()\n     *   .or()\n     *   .startGroup()\n     *     .match(\"Rivers\")\n     *     .in(\"title\")\n     *   .endGroup()\n     * ```\n     */\n    SearchQueryBuilder.prototype.endGroup = function () {\n        if (this.openGroups <= 0) {\n            warn(\"`endGroup(...)` was called without calling `startGroup(...)` first. Your query was not modified.\");\n            return this;\n        }\n        this.commit();\n        this.openGroups--;\n        this.q += \")\";\n        return this;\n    };\n    /**\n     * Joins two sets of queries with an `AND` clause.\n     *\n     * ```js\n     * const query = new SearchQueryBuilder()\n     *   .match(\"Lakes\")\n     *   .in(\"title\")\n     *   .and()\n     *   .match(\"Rivers\")\n     *   .in(\"title\")\n     * ```\n     */\n    SearchQueryBuilder.prototype.and = function () {\n        return this.addModifier(\"and\");\n    };\n    /**\n     * Joins two sets of queries with an `OR` clause.\n     *\n     * ```js\n     * const query = new SearchQueryBuilder()\n     *   .match(\"Lakes\")\n     *   .in(\"title\")\n     *   .or()\n     *   .match(\"Rivers\")\n     *   .in(\"title\")\n     * ```\n     */\n    SearchQueryBuilder.prototype.or = function () {\n        return this.addModifier(\"or\");\n    };\n    /**\n     * Joins two sets of queries with a `NOT` clause. Another option for filtering results is the [prohibit operator '-'](https://developers.arcgis.com/rest/users-groups-and-items/search-reference.htm#ESRI_SECTION1_5C6C35DB9E4A4F4492C5B937BDA2BF67).\n     *\n     * ```js\n     * // omit results with \"Rivers\" in their title\n     * const query = new SearchQueryBuilder()\n     *   .not()\n     *   .match(\"Rivers\")\n     *   .in(\"title\")\n     *\n     * // equivalent\n     * const query = new SearchQueryBuilder()\n     *   .match(\"Rivers\")\n     *   .in(\"-title\")\n     * ```\n     */\n    SearchQueryBuilder.prototype.not = function () {\n        return this.addModifier(\"not\");\n    };\n    /**\n     * Begins a new range query.\n     *\n     * ```js\n     *\n     * const NEWYEARS = new Date(\"2020-01-01\")\n     * const TODAY = new Date()\n     *\n     * const query = new SearchQueryBuilder()\n     *   .from(NEWYEARS)\n     *   .to(TODAY)\n     *   .in(\"created\")\n     * ```\n     */\n    SearchQueryBuilder.prototype.from = function (term) {\n        if (this.hasTerms) {\n            warn(\n            // apparently-p*rettier-ignore causes prettier to strip *all* comments O_o\n            \"`from(...)` is not allowed after `match(...)` try using `.from(...).to(...).in(...)`. Optionally, you may see this because dates are incorrectly formatted. Dates should be a primative Date value, aka a number in milliseconds or Date object, ie new Date(\\\"2020-01-01\\\").  Your query was not modified.\");\n            return this;\n        }\n        this.rangeStack[0] = term;\n        return this;\n    };\n    /**\n     * Ends a range query.\n     *\n     * ```js\n     * const query = new SearchQueryBuilder()\n     *   .from(yesterdaysDate)\n     *   .to(todaysDate)\n     *   .in(\"created\")\n     * ```\n     */\n    SearchQueryBuilder.prototype.to = function (term) {\n        if (this.hasTerms) {\n            warn(\n            // apparently-p*rettier-ignore causes prettier to strip *all* comments O_o\n            \"`to(...)` is not allowed after `match(...)` try using `.from(...).to(...).in(...)`. Optionally, you may see this because dates are incorrectly formatted. Dates should be a primative Date value, aka a number in milliseconds or Date object, ie new Date(\\\"2020-01-01\\\"). Your query was not modified.\");\n            return this;\n        }\n        this.rangeStack[1] = term;\n        return this;\n    };\n    /**\n     * Boosts the previous term to increase its rank in the results.\n     *\n     * ```js\n     * const query = new SearchQueryBuilder()\n     *   .match(\"Lakes\")\n     *   .in(\"title\")\n     *   .or()\n     *   .match(\"Rivers\")\n     *   .in(\"title\")\n     *   .boost(3)\n     * ```\n     */\n    SearchQueryBuilder.prototype.boost = function (num) {\n        this.commit();\n        this.q += \"^\" + num;\n        return this;\n    };\n    /**\n     * Returns the current query string. Called internally when the request is made.\n     */\n    SearchQueryBuilder.prototype.toParam = function () {\n        this.commit();\n        this.cleanup();\n        return this.q;\n    };\n    /**\n     * Returns a new instance of `SearchQueryBuilder` based on the current instance.\n     */\n    SearchQueryBuilder.prototype.clone = function () {\n        this.commit();\n        this.cleanup();\n        return new SearchQueryBuilder(this.q + \"\");\n    };\n    SearchQueryBuilder.prototype.addModifier = function (modifier) {\n        if (this.currentModifer) {\n            warn(\n            // apparently-p*rettier-ignore causes prettier to strip *all* comments O_o\n            \"You have called `\" + this.currentModifer + \"()` after `\" + modifier + \"()`. Your current query was not modified.\");\n            return this;\n        }\n        this.commit();\n        if (this.q === \"\" && modifier !== \"not\") {\n            warn(\"You have called `\" + modifier + \"()` without calling another method to modify your query first. Try calling `match()` first.\");\n            return this;\n        }\n        this.currentModifer = modifier;\n        this.q += this.q === \"\" ? \"\" : \" \";\n        this.q += modifier.toUpperCase() + \" \";\n        return this;\n    };\n    SearchQueryBuilder.prototype.needsQuotes = function (s) {\n        return /\\s|:/g.test(s);\n    };\n    SearchQueryBuilder.prototype.formatTerm = function (term) {\n        if (term instanceof Date) {\n            return term.getTime();\n        }\n        if (typeof term === \"string\" && this.needsQuotes(term)) {\n            return \"\\\"\" + term + \"\\\"\";\n        }\n        return term;\n    };\n    SearchQueryBuilder.prototype.commit = function () {\n        var _this = this;\n        this.currentModifer = undefined;\n        if (this.hasRange) {\n            this.q += \"[\" + this.formatTerm(this.rangeStack[0]) + \" TO \" + this.formatTerm(this.rangeStack[1]) + \"]\";\n            this.rangeStack = [undefined, undefined];\n        }\n        if (this.hasTerms) {\n            this.q += this.termStack\n                .map(function (term) {\n                return _this.formatTerm(term);\n            })\n                .join(\" \");\n            this.termStack = [];\n        }\n        return this;\n    };\n    Object.defineProperty(SearchQueryBuilder.prototype, \"hasTerms\", {\n        get: function () {\n            return this.termStack.length > 0;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SearchQueryBuilder.prototype, \"hasRange\", {\n        get: function () {\n            return this.rangeStack.length && this.rangeStack[0] && this.rangeStack[1];\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SearchQueryBuilder.prototype.cleanup = function () {\n        // end a group if we have started one\n        if (this.openGroups > 0) {\n            warn(\n            // apparently-p*rettier-ignore causes prettier to strip *all* comments O_o\n            \"Automatically closing \" + this.openGroups + \" group(s). You can use `endGroup(...)` to remove this warning.\");\n            while (this.openGroups > 0) {\n                this.q += \")\";\n                this.openGroups--;\n            }\n        }\n        var oldQ = this.q;\n        this.q = oldQ.replace(/( AND ?| NOT ?| OR ?)*$/, \"\");\n        if (oldQ !== this.q) {\n            warn(\"`startGroup(...)` was called without calling `endGroup(...)` first. Your query was not modified.\");\n        }\n        // clear empty groups\n        this.q = this.q.replace(/(\\(\\))*/, \"\");\n    };\n    return SearchQueryBuilder;\n}());\nexport { SearchQueryBuilder };\n//# sourceMappingURL=SearchQueryBuilder.js.map","/* Copyright (c) 2018 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\nimport { request, appendCustomParams, } from \"@esri/arcgis-rest-request\";\nimport { SearchQueryBuilder } from \"./SearchQueryBuilder\";\nimport { getPortalUrl } from \"../util/get-portal-url\";\nexport function genericSearch(search, searchType) {\n    var options;\n    if (typeof search === \"string\" || search instanceof SearchQueryBuilder) {\n        options = {\n            httpMethod: \"GET\",\n            params: {\n                q: search,\n            },\n        };\n    }\n    else {\n        // searchUserAccess has one (knonw) valid value: \"groupMember\"\n        options = appendCustomParams(search, [\n            \"q\",\n            \"num\",\n            \"start\",\n            \"sortField\",\n            \"sortOrder\",\n            \"searchUserAccess\",\n            \"searchUserName\",\n            \"filter\",\n            \"countFields\",\n            \"countSize\",\n            \"categories\",\n            \"categoryFilters\",\n        ], {\n            httpMethod: \"GET\",\n        });\n    }\n    var path;\n    switch (searchType) {\n        case \"item\":\n            path = \"/search\";\n            break;\n        case \"group\":\n            path = \"/community/groups\";\n            break;\n        case \"groupContent\":\n            // Need to have groupId property to do group contents search,\n            // cso filter out all but ISearchGroupContentOptions\n            if (typeof search !== \"string\" &&\n                !(search instanceof SearchQueryBuilder) &&\n                search.groupId) {\n                path = \"/content/groups/\" + search.groupId + \"/search\";\n            }\n            else {\n                return Promise.reject(new Error(\"you must pass a `groupId` option to `searchGroupContent`\"));\n            }\n            break;\n        default:\n            // \"users\"\n            path = \"/portals/self/users/search\";\n            break;\n    }\n    var url = getPortalUrl(options) + path;\n    // send the request\n    return request(url, options).then(function (r) {\n        if (r.nextStart && r.nextStart !== -1) {\n            r.nextPage = function () {\n                var newOptions;\n                if (typeof search === \"string\" ||\n                    search instanceof SearchQueryBuilder) {\n                    newOptions = {\n                        q: search,\n                        start: r.nextStart,\n                    };\n                }\n                else {\n                    newOptions = search;\n                    newOptions.start = r.nextStart;\n                }\n                return genericSearch(newOptions, searchType);\n            };\n        }\n        return r;\n    });\n}\n//# sourceMappingURL=generic-search.js.map","/* Copyright (c) 2019 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\nexport function chunk(array, size) {\n    if (array.length === 0) {\n        return [];\n    }\n    var chunks = [];\n    for (var i = 0; i < array.length; i += size) {\n        chunks.push(array.slice(i, i + size));\n    }\n    return chunks;\n}\n//# sourceMappingURL=array.js.map","/* Copyright (c) 2017-2018 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\nimport { __assign, __spreadArrays } from \"tslib\";\nimport { request } from \"@esri/arcgis-rest-request\";\nimport { getPortalUrl } from \"../util/get-portal-url\";\nimport { chunk } from \"../util/array\";\n/**\n * ```js\n * import { addGroupUsers } from \"@esri/arcgis-rest-portal\";\n * //\n * addGroupUsers({\n *   id: groupId,\n *   users: [\"username1\", \"username2\"],\n *   admins: [\"username3\"],\n *   authentication\n * })\n * .then(response);\n * ```\n * Add users to a group. See the [REST Documentation](https://developers.arcgis.com/rest/users-groups-and-items/add-users-to-group.htm) for more information.\n *\n * @param requestOptions  - Options for the request\n * @returns A Promise\n */\nexport function addGroupUsers(requestOptions) {\n    var id = requestOptions.id;\n    var url = getPortalUrl(requestOptions) + \"/community/groups/\" + id + \"/addUsers\";\n    var baseOptions = Object.assign({}, requestOptions, {\n        admins: undefined,\n        users: undefined\n    });\n    var batchRequestOptions = __spreadArrays(_prepareRequests(\"users\", requestOptions.users, baseOptions), _prepareRequests(\"admins\", requestOptions.admins, baseOptions));\n    var promises = batchRequestOptions.map(function (options) {\n        return _sendSafeRequest(url, options);\n    });\n    return Promise.all(promises).then(_consolidateRequestResults);\n}\nfunction _prepareRequests(type, usernames, baseOptions) {\n    if (!usernames || usernames.length < 1) {\n        return [];\n    }\n    // the ArcGIS REST API only allows to add no more than 25 users per request,\n    // see https://developers.arcgis.com/rest/users-groups-and-items/add-users-to-group.htm\n    var userChunks = chunk(usernames, 25);\n    return userChunks.map(function (users) {\n        return _generateRequestOptions(type, users, baseOptions);\n    });\n}\nfunction _generateRequestOptions(type, usernames, baseOptions) {\n    var _a, _b;\n    return Object.assign({}, baseOptions, (_a = {},\n        _a[type] = usernames,\n        _a.params = __assign(__assign({}, baseOptions.params), (_b = {}, _b[type] = usernames, _b)),\n        _a));\n}\n// this request is safe since the request error will be handled\nfunction _sendSafeRequest(url, requestOptions) {\n    return request(url, requestOptions).catch(function (error) {\n        return {\n            errors: [error]\n        };\n    });\n}\nfunction _consolidateRequestResults(results) {\n    var notAdded = results\n        .filter(function (result) { return result.notAdded; })\n        .reduce(function (collection, result) { return collection.concat(result.notAdded); }, []);\n    var errors = results\n        .filter(function (result) { return result.errors; })\n        .reduce(function (collection, result) { return collection.concat(result.errors); }, []);\n    var consolidated = { notAdded: notAdded };\n    if (errors.length > 0) {\n        consolidated.errors = errors;\n    }\n    return consolidated;\n}\n//# sourceMappingURL=add-users.js.map","/* Copyright (c) 2017-2018 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\nimport { __assign } from \"tslib\";\nimport { request } from \"@esri/arcgis-rest-request\";\nimport { getPortalUrl } from \"../util/get-portal-url\";\nimport { chunk } from \"../util/array\";\n/**\n * ```js\n * import { removeGroupUsers } from \"@esri/arcgis-rest-portal\";\n * //\n * removeGroupUsers({\n *   id: groupId,\n *   users: [\"username1\", \"username2\"],\n *   authentication\n * })\n * .then(response);\n * ```\n * Add users to a group. See the [REST Documentation](https://developers.arcgis.com/rest/users-groups-and-items/remove-users-from-group.htm) for more information.\n *\n * @param requestOptions  - Options for the request\n * @returns A Promise\n */\nexport function removeGroupUsers(requestOptions) {\n    var id = requestOptions.id, usersToRemove = requestOptions.users;\n    var url = getPortalUrl(requestOptions) + \"/community/groups/\" + id + \"/removeUsers\";\n    var safeSend = function (users) {\n        var options = __assign(__assign({}, requestOptions), { users: users, params: { users: users } });\n        return request(url, options)\n            .catch(function (error) { return ({ errors: [error] }); });\n    };\n    // the ArcGIS REST API only allows to add no more than 25 users per request,\n    // see https://developers.arcgis.com/rest/users-groups-and-items/remove-users-from-group.htm\n    var promises = chunk(usersToRemove, 25).map(function (usersChunk) { return safeSend(usersChunk); });\n    return Promise.all(promises)\n        .then(function (results) {\n        var filtered = function (propName) { return results\n            .filter(function (result) { return result[propName]; })\n            .reduce(function (collection, result) { return collection.concat(result[propName]); }, []); };\n        var errors = filtered('errors');\n        var consolidated = { notRemoved: filtered('notRemoved') };\n        return errors.length ? __assign(__assign({}, consolidated), { errors: errors }) : consolidated;\n    });\n}\n//# sourceMappingURL=remove-users.js.map","/* Copyright (c) 2018-2019 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\nimport { genericSearch } from \"../util/generic-search\";\n/**\n * ```js\n * import { searchGroups } from \"@esri/arcgis-rest-portal\";\n * //\n * searchGroups('water')\n *   .then(response) // response.total => 355\n * ```\n * Search a portal for groups. See the [REST Documentation](https://developers.arcgis.com/rest/users-groups-and-items/group-search.htm) for more information.\n *\n * @param search - A string or RequestOptions object to pass through to the endpoint.\n * @returns A Promise that will resolve with the data from the response.\n */\nexport function searchGroups(search) {\n    return genericSearch(search, \"group\");\n}\n/**\n * ```js\n * import { searchGroupContent } from \"@esri/arcgis-rest-portal\";\n * //\n * searchGroupContent('water')\n *   .then(response) // response.total => 355\n * ```\n * Search a portal for items in a group. See the [REST Documentation](https://developers.arcgis.com/rest/users-groups-and-items/group-content-search.htm) for more information.\n *\n * @param options - RequestOptions object amended with search parameters.\n * @returns A Promise that will resolve with the data from the response.\n */\nexport function searchGroupContent(options) {\n    return genericSearch(options, \"groupContent\");\n}\n//# sourceMappingURL=search.js.map","import { searchGroups } from \"@esri/arcgis-rest-portal\";\n/**\n * Does a group with the specified title exist in the users org?\n * @param {String} title Group Title\n * @param {IHubRequestOptions} hubRequestOptions\n */\nexport function doesGroupExist(title, hubRequestOptions) {\n    var orgId = hubRequestOptions.portalSelf.id;\n    var searchOpts = {\n        q: \"(title:\\\"\" + title + \"\\\" accountid:\" + orgId + \")\",\n        authentication: hubRequestOptions.authentication\n    };\n    return searchGroups(searchOpts)\n        .then(function (searchResponse) { return searchResponse.results.length > 0; })\n        .catch(function (err) {\n        throw Error(\"Error in team-utils::doesGroupExist \" + err);\n    });\n}\n//# sourceMappingURL=does-group-exist.js.map","import { doesGroupExist } from \"./does-group-exist\";\n/**\n * Given a title, construct a group title that is unique\n * in the user's org.\n * Given a title of \"Medical Team\", if a group with that title exists\n * this fn will add a number on the end, and increment until\n * an available group title is found - i.e. \"Medical Team 3\"\n * @param {String} title Group Title to ensure if unique\n * @param {IHubRequestOptions} hubRequestOptions\n * @param {Number} step Number to increment. Defaults to 0\n */\nexport function getUniqueGroupTitle(title, hubRequestOptions, step) {\n    if (step === void 0) { step = 0; }\n    var combinedName = title;\n    if (step) {\n        combinedName = title + \" \" + step;\n    }\n    return doesGroupExist(combinedName, hubRequestOptions)\n        .then(function (result) {\n        if (result) {\n            step++;\n            return getUniqueGroupTitle(title, hubRequestOptions, step);\n        }\n        else {\n            return combinedName;\n        }\n    })\n        .catch(function (err) {\n        throw Error(\"Error in team-utils::getUniqueGroupTitle \" + err);\n    });\n}\n//# sourceMappingURL=get-unique-group-title.js.map","/**\n * Portal Priviledges required to set group access to specific levels\n */\nexport var GROUP_ACCESS_PRIVS = {\n    public: [\"portal:user:createGroup\", \"portal:user:shareGroupToPublic\"],\n    org: [\"portal:user:createGroup\", \"portal:user:shareGroupToOrg\"],\n    private: [\"portal:user:createGroup\"]\n};\n//# sourceMappingURL=group-access-privs.js.map","import { hasAllPrivileges } from \"./has-all-privileges\";\nimport { GROUP_ACCESS_PRIVS } from \"./group-access-privs\";\nimport { getProp } from \"@esri/hub-common\";\n/**\n * Returns the allowed group access based on a user's privileges\n * and org level settings\n * @param requestedAccess public || org || private\n * @param user User object w/ privileges array\n * @param portal optional\n */\nexport function getAllowedGroupAccess(requestedAccess, user, portal) {\n    // portal-wide flag takes presidence, and is not sync'd with privs\n    var portalWideCanSharePublic = getProp(portal, \"canSharePublic\") || false;\n    // compute what access level the current user can create the group with\n    var canCreatePublic = portalWideCanSharePublic &&\n        hasAllPrivileges(user, GROUP_ACCESS_PRIVS.public);\n    var canCreateOrg = hasAllPrivileges(user, GROUP_ACCESS_PRIVS.org);\n    // default to the requested access...\n    var result = requestedAccess;\n    // if they requested public, but can't make public...\n    if (requestedAccess === \"public\" && !canCreatePublic) {\n        // step down to org...\n        result = \"org\";\n        // but if they can't do that...\n        if (!canCreateOrg) {\n            // then do private\n            result = \"private\";\n        }\n    }\n    else {\n        // if the requsted access was not public, it's either org or private\n        // and if they can't create do org...\n        if (requestedAccess === \"org\" && !canCreateOrg) {\n            // must be private\n            result = \"private\";\n        }\n    }\n    return result;\n}\n//# sourceMappingURL=get-allowed-group-access.js.map","import { createGroup, protectGroup } from \"@esri/arcgis-rest-portal\";\nimport { getUniqueGroupTitle } from \"./get-unique-group-title\";\nimport { getAllowedGroupAccess } from \"./get-allowed-group-access\";\n/**\n * Create a team group. Will ensure the team name is unique in the users org\n * and return the group, with appropriate `.userMembership` attached.\n * @param {Object} user Current User\n * @param {Object} group Group to create\n * @param {IHubRequestOptions} hubRequestOptions\n * @private\n */\nexport function _createTeamGroup(user, group, hubRequestOptions) {\n    group.access = getAllowedGroupAccess(group.access, user, hubRequestOptions.portalSelf);\n    return getUniqueGroupTitle(group.title, hubRequestOptions)\n        .then(function (uniqueTitle) {\n        group.title = uniqueTitle;\n        return createGroup({\n            group: group,\n            authentication: hubRequestOptions.authentication\n        });\n    })\n        .then(function (createResponse) {\n        group.id = createResponse.group.id;\n        return protectGroup({\n            id: group.id,\n            authentication: hubRequestOptions.authentication\n        });\n    })\n        .then(function () {\n        group.userMembership = {\n            username: user.username,\n            memberType: \"owner\",\n            applications: 0\n        };\n        return group;\n    })\n        .catch(function (ex) {\n        throw Error(\"Error in team-utils::_createTeamGroup \" + ex);\n    });\n}\n//# sourceMappingURL=_create-team-group.js.map","/* Copyright (c) 2017-2018 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\nimport { __assign } from \"tslib\";\nimport { request } from \"@esri/arcgis-rest-request\";\nimport { getPortalUrl } from \"../util/get-portal-url\";\n/**\n * ```js\n * import { createGroup } from \"@esri/arcgis-rest-portal\";\n * //\n * createGroup({\n *   group: {\n *     title: \"No Homers\",\n *     access: \"public\"\n *   },\n *   authentication\n * })\n *   .then(response)\n * ```\n * Create a new Group. See the [REST Documentation](https://developers.arcgis.com/rest/users-groups-and-items/create-group.htm) for more information.\n *\n * Note: The group name must be unique within the user's organization.\n * @param requestOptions  - Options for the request, including a group object\n * @returns A Promise that will resolve with the success/failure status of the request\n */\nexport function createGroup(requestOptions) {\n    var url = getPortalUrl(requestOptions) + \"/community/createGroup\";\n    requestOptions.params = __assign(__assign({}, requestOptions.params), requestOptions.group);\n    return request(url, requestOptions);\n}\n//# sourceMappingURL=create.js.map","/* Copyright (c) 2017-2018 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\nimport { request } from \"@esri/arcgis-rest-request\";\nimport { getPortalUrl } from \"../util/get-portal-url\";\n/**\n * ```js\n * import { protectGroup } from '@esri/arcgis-rest-portal';\n * //\n * protectGroup({\n *   id: groupId,\n *   authentication\n * })\n *   .then(response)\n * ```\n * Protect a group to avoid accidental deletion. See the [REST Documentation](https://developers.arcgis.com/rest/users-groups-and-items/protect-group.htm) for more information.\n *\n * @param requestOptions - Options for the request\n * @returns A Promise that will resolve with the success/failure status of the request\n */\nexport function protectGroup(requestOptions) {\n    var url = getPortalUrl(requestOptions) + \"/community/groups/\" + requestOptions.id + \"/protect\";\n    return request(url, requestOptions);\n}\n/**\n * ```js\n * import { unprotectGroup } from '@esri/arcgis-rest-portal';\n * //\n * unprotectGroup({\n *   id: groupId,\n *   authentication\n * })\n *   .then(response)\n * ```\n * Unprotect a Group. See the [REST Documentation](https://developers.arcgis.com/rest/users-groups-and-items/unprotect-group.htm) for more information.\n * @param requestOptions - Options for the request\n * @returns A Promise that will resolve with the success/failure status of the request\n */\nexport function unprotectGroup(requestOptions) {\n    var url = getPortalUrl(requestOptions) + \"/community/groups/\" + requestOptions.id + \"/unprotect\";\n    return request(url, requestOptions);\n}\n//# sourceMappingURL=protect.js.map","import { _translateTeamTemplate } from \"./_translate-team-template\";\nimport { _createTeamGroup } from \"./_create-team-group\";\n/**\n * Internal: Actually create the team groups\n * @param {String} title Title for the Team group\n * @param {Array} groupTemplates Array of group definitions to create the groups\n * @param {IHubRequestOptions} hubRequestOptions\n * @private\n */\nexport function _createTeamGroups(title, groupTemplates, translations, hubRequestOptions) {\n    // now translate the templates...\n    var translatedTemplates = groupTemplates.map(function (tmpl) {\n        return _translateTeamTemplate(tmpl, title, translations);\n    });\n    // now we actually create the groups... obvs async...\n    return Promise.all(translatedTemplates.map(function (grpTmpl) {\n        return _createTeamGroup(hubRequestOptions.portalSelf.user, grpTmpl, hubRequestOptions);\n    }))\n        .then(function (groups) {\n        // hoist out the id's into a structure that has the groupnameProperty: id\n        var props = groups.reduce(function (acc, grp) {\n            // assign to the property, if one is specified\n            if (grp.config.propertyName) {\n                acc[grp.config.propertyName] = grp.id;\n            }\n            return acc;\n        }, {});\n        // remove config node\n        groups.forEach(function (g) { return delete g.config; });\n        // construct the return the hash...\n        // props: the props which can be spread into the item.properties hash..\n        // groups: the array of groups that were created\n        return {\n            props: props,\n            groups: groups\n        };\n    })\n        .catch(function (ex) {\n        throw Error(\"Error in team-utils::_createTeamGroups \" + ex);\n    });\n}\n//# sourceMappingURL=_create-team-groups.js.map","import { getProp, getHubProduct, getSubscriptionType, } from \"@esri/hub-common\";\nimport { getUserCreatableTeams } from \"./get-user-creatable-teams\";\n/**\n * Determine if the current user can create a specific type of team\n * @param {Object} user Current User\n * @param {HubTeamType} hubTeamType\n * @param {*} hubRequestOptions\n */\nexport function canUserCreateTeam(user, hubTeamType, hubRequestOptions) {\n    var userGroups = getProp(user, \"groups\") || [];\n    if (userGroups.length > 510) {\n        return false;\n    }\n    else {\n        var portalSelf = hubRequestOptions.portalSelf;\n        var product = getHubProduct(portalSelf);\n        var subscriptionType = getSubscriptionType(portalSelf);\n        // get all the groups the user can create in this product...\n        return getUserCreatableTeams(user, product, portalSelf.currentVersion, subscriptionType).some(function (t) { return t.config.type === hubTeamType; });\n    }\n}\n//# sourceMappingURL=can-user-create-team.js.map","import { cloneObject } from \"@esri/hub-common\";\nimport { WELLKNOWNTEAMS } from \"../well-known-teams\";\n// TODO: at next breaking change remove portalApiVersion param\n/**\n * Given a product, return the groups templates that are available\n * @param {string} product Product name portal | basic | premium\n */\nexport function getTeamsAvailableInProduct(product, portalApiVersion // DEPRECATED\n) {\n    /* tslint:disable no-console */\n    console.warn(\"Hub.js::getTeamsAvailableInProduct Deprecation warning portalApiVersion will be removed at v10.0.0\");\n    /* tslint:enable no-console */\n    var teams = WELLKNOWNTEAMS;\n    var filterFn = function (tmpl) {\n        return tmpl.config.availableIn.indexOf(product) > -1;\n    };\n    return cloneObject(teams).filter(filterFn);\n}\n//# sourceMappingURL=get-teams-available-in-product.js.map","/**\n * Enum of the types of teams mapped to their item properties\n */\nexport var TYPEMAP = {\n    core: \"collaborationGroupId\",\n    content: \"contentGroupId\",\n    followers: \"followersGroupId\"\n};\n//# sourceMappingURL=type-map.js.map","import { getGroup } from \"@esri/arcgis-rest-portal\";\n/**\n * Get a team by id\n * @param {string} id group id\n * @param {IRequestOptions} hubRequestOptions\n * @returns {Promise<IGroup>}\n */\nexport function getTeamById(id, hubRequestOptions) {\n    return getGroup(id, hubRequestOptions);\n}\n//# sourceMappingURL=get-team-by-id.js.map","/* Copyright (c) 2017-2018 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\nimport { __assign } from \"tslib\";\nimport { request, appendCustomParams } from \"@esri/arcgis-rest-request\";\nimport { getPortalUrl } from \"../util/get-portal-url\";\n/**\n * ```js\n * import { getGroup } from \"@esri/arcgis-rest-portal\";\n * //\n * getGroup(\"fxb988\") // id\n *   .then(response)\n * ```\n * Fetch a group using its id. See the [REST Documentation](https://developers.arcgis.com/rest/users-groups-and-items/group.htm) for more information.\n *\n * @param id - Group Id\n * @param requestOptions  - Options for the request\n * @returns  A Promise that will resolve with the data from the response.\n */\nexport function getGroup(id, requestOptions) {\n    var url = getPortalUrl(requestOptions) + \"/community/groups/\" + id;\n    // default to a GET request\n    var options = __assign({ httpMethod: \"GET\" }, requestOptions);\n    return request(url, options);\n}\n/**\n * Gets the category schema set on a group\n *\n * @param id - Group Id\n * @param requestOptions  - Options for the request\n * @returns A promise that will resolve with JSON of group's category schema\n * @see https://developers.arcgis.com/rest/users-groups-and-items/group-category-schema.htm\n */\nexport function getGroupCategorySchema(id, requestOptions) {\n    var url = getPortalUrl(requestOptions) + \"/community/groups/\" + id + \"/categorySchema\";\n    // default to a GET request\n    var options = __assign({ httpMethod: \"GET\" }, requestOptions);\n    return request(url, options);\n}\n/**\n * Returns the content of a Group. Since the group may contain 1000s of items\n * the requestParams allow for paging.\n * @param id - Group Id\n * @param requestOptions  - Options for the request, including paging parameters.\n * @returns  A Promise that will resolve with the content of the group.\n */\nexport function getGroupContent(id, requestOptions) {\n    var url = getPortalUrl(requestOptions) + \"/content/groups/\" + id;\n    // default to a GET request\n    var options = __assign(__assign({ httpMethod: \"GET\" }, { params: { start: 1, num: 100 } }), requestOptions);\n    // is this the most concise way to mixin with the defaults above?\n    if (requestOptions && requestOptions.paging) {\n        options.params = __assign({}, requestOptions.paging);\n    }\n    return request(url, options);\n}\n/**\n * Get the usernames of the admins and members. Does not return actual 'User' objects. Those must be\n * retrieved via separate calls to the User's API.\n * @param id - Group Id\n * @param requestOptions - Options for the request\n * @returns A Promise that will resolve with arrays of the group admin usernames and the member usernames\n */\nexport function getGroupUsers(id, requestOptions) {\n    var url = getPortalUrl(requestOptions) + \"/community/groups/\" + id + \"/users\";\n    // default to a GET request\n    var options = __assign({ httpMethod: \"GET\" }, requestOptions);\n    return request(url, options);\n}\n/**\n * ```js\n * import { searchGroupUsers } from \"@esri/arcgis-rest-portal\";\n * //\n * searchGroupUsers('abc123')\n *   .then(response)\n * ```\n * Search the users in a group. See the [REST Documentation](https://developers.arcgis.com/rest/users-groups-and-items/group-users-list.htm) for more information.\n *\n * @param id - The group id\n * @param searchOptions - Options for the request, including paging parameters.\n * @returns A Promise that will resolve with the data from the response.\n */\nexport function searchGroupUsers(id, searchOptions) {\n    var url = getPortalUrl(searchOptions) + \"/community/groups/\" + id + \"/userlist\";\n    var options = appendCustomParams(searchOptions || {}, [\"name\", \"num\", \"start\", \"sortField\", \"sortOrder\", \"joined\", \"memberType\"], {\n        httpMethod: \"GET\"\n    });\n    return request(url, options);\n}\n//# sourceMappingURL=get.js.map","import { __awaiter, __generator } from \"tslib\";\n/**\n * @private\n * Returns an empty instance of the addorinviteresponse object.\n * We are using this because if you leave out any of the props\n * from the final object and you are concatting together arrays you can concat\n * an undeifined inside an array which will throw off array lengths.\n *\n * @export\n * @return {IAddOrInviteResponse}\n */\nexport function handleNoUsers(context, userType, shouldEmail) {\n    return __awaiter(this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            return [2 /*return*/, {\n                    notAdded: [],\n                    notEmailed: [],\n                    notInvited: [],\n                    users: [],\n                    errors: [],\n                }];\n        });\n    });\n}\n//# sourceMappingURL=handle-no-users.js.map","import { addGroupUsers, } from \"@esri/arcgis-rest-portal\";\n/**\n * @private\n * Auto add N users to a single group, with users added as admins of that group\n *\n * @export\n * @param {string} id Group ID\n * @param {IUser[]} admins array of users to add to group as admin\n * @param {IAuthenticationManager} authentication authentication manager\n * @return {IAddGroupUsersResult} Result of the transaction (null if no users are passed in)\n */\nexport function autoAddUsersAsAdmins(id, admins, authentication) {\n    var response = Promise.resolve(null);\n    if (admins.length) {\n        var args = {\n            id: id,\n            admins: admins.map(function (a) { return a.username; }),\n            authentication: authentication,\n        };\n        response = addGroupUsers(args);\n    }\n    return response;\n}\n//# sourceMappingURL=auto-add-users-as-admins.js.map","import { __awaiter, __generator } from \"tslib\";\nimport { getProp, emailOrgUsers } from \"@esri/hub-common\";\n/**\n * @private\n * Governs the logic for emailing N users. It acts under the assumption\n * that all the 'community' users are the ones being emailed (this is due to platform rules we conform to)\n * Function is called upstream depending on if an email object is attached to the context.\n * Email object contains its own auth as it'll require the community admin to send the email itself.\n * An individual email call goes out for each user due to how the response of multiple users in a single call works.\n *\n * @export\n * @param {IAddOrInviteContext} context context object\n * @return {IAddOrInviteResponse} response object\n */\nexport function processEmailUsers(context) {\n    return __awaiter(this, void 0, void 0, function () {\n        var users, notEmailed, errors, _i, users_1, user, emailResponse;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    users = getProp(context, \"community\");\n                    notEmailed = [];\n                    errors = [];\n                    _i = 0, users_1 = users;\n                    _a.label = 1;\n                case 1:\n                    if (!(_i < users_1.length)) return [3 /*break*/, 4];\n                    user = users_1[_i];\n                    return [4 /*yield*/, emailOrgUsers([user], getProp(context, \"email.message\"), getProp(context, \"email.auth\"), true)];\n                case 2:\n                    emailResponse = _a.sent();\n                    // If it's just a failed email\n                    // then add username to notEmailed array\n                    if (!emailResponse.success) {\n                        notEmailed.push(user.username);\n                        // If there was a legit error\n                        // Then only the error returns from\n                        // online. Add error AND include username in notEmailed array.\n                        if (emailResponse.errors) {\n                            errors = errors.concat(emailResponse.errors);\n                        }\n                    }\n                    _a.label = 3;\n                case 3:\n                    _i++;\n                    return [3 /*break*/, 1];\n                case 4: \n                // if you leave out any of the props\n                // from the final object and you are concatting together arrays you can concat\n                // an undeifined inside an array which will throw off array lengths.\n                return [2 /*return*/, {\n                        users: users.map(function (u) { return u.username; }),\n                        notEmailed: notEmailed,\n                        errors: errors,\n                        notInvited: [],\n                        notAdded: [],\n                    }];\n            }\n        });\n    });\n}\n//# sourceMappingURL=process-email-users.js.map","import { __awaiter, __generator } from \"tslib\";\nimport { autoAddUsers, getProp } from \"@esri/hub-common\";\nimport { autoAddUsersAsAdmins } from \"./auto-add-users-as-admins\";\nimport { processEmailUsers } from \"./process-email-users\";\n/**\n * @private\n * Governs logic for automatically adding N users to a group.\n * Users are added as either a regular user OR as an administrator of the group\n * depending on the addUserAsGroupAdmin prop on the IAddOrInviteContext.\n * If there is an email object on the IAddOrInviteContext, then email notifications are sent.\n *\n * @export\n * @param {IAddOrInviteContext} context context object\n * @param {string} userType what type of user is it: org | world | community\n * @param {boolean} [shouldEmail=false] should the user be emailed?\n * @return {IAddOrInviteResponse} response object\n */\nexport function processAutoAddUsers(context, userType, shouldEmail) {\n    if (shouldEmail === void 0) { shouldEmail = false; }\n    return __awaiter(this, void 0, void 0, function () {\n        var users, autoAddResponse, emailResponse, notAdded, errors, addUserAsGroupAdmin;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    users = getProp(context, userType);\n                    notAdded = [];\n                    errors = [];\n                    addUserAsGroupAdmin = context.addUserAsGroupAdmin;\n                    if (!addUserAsGroupAdmin) return [3 /*break*/, 2];\n                    return [4 /*yield*/, autoAddUsersAsAdmins(getProp(context, \"groupId\"), users, getProp(context, \"primaryRO\"))];\n                case 1:\n                    // if is core team we elevate user to admin\n                    autoAddResponse = _a.sent();\n                    return [3 /*break*/, 4];\n                case 2: return [4 /*yield*/, autoAddUsers(getProp(context, \"groupId\"), users, getProp(context, \"primaryRO\"))];\n                case 3:\n                    // if not then we are just auto adding them\n                    autoAddResponse = _a.sent();\n                    _a.label = 4;\n                case 4:\n                    // handle notAdded users\n                    if (autoAddResponse.notAdded) {\n                        notAdded = notAdded.concat(autoAddResponse.notAdded);\n                    }\n                    // Merge errors into empty array\n                    if (autoAddResponse.errors) {\n                        errors = errors.concat(autoAddResponse.errors);\n                    }\n                    if (!shouldEmail) return [3 /*break*/, 6];\n                    return [4 /*yield*/, processEmailUsers(context)];\n                case 5:\n                    emailResponse = _a.sent();\n                    // merge errors in to overall errors array to keep things flat\n                    if (emailResponse.errors && emailResponse.errors.length > 0) {\n                        errors = errors.concat(emailResponse.errors);\n                    }\n                    _a.label = 6;\n                case 6: \n                // if you leave out any of the props\n                // from the final object and you are concatting together arrays you can concat\n                // an undeifined inside an array which will throw off array lengths.\n                return [2 /*return*/, {\n                        users: users.map(function (u) { return u.username; }),\n                        notAdded: notAdded,\n                        errors: errors,\n                        notEmailed: (emailResponse === null || emailResponse === void 0 ? void 0 : emailResponse.notEmailed) || [],\n                        notInvited: [],\n                    }];\n            }\n        });\n    });\n}\n//# sourceMappingURL=process-auto-add-users.js.map","import { __awaiter, __generator } from \"tslib\";\nimport { getProp, inviteUsers } from \"@esri/hub-common\";\n/**\n * @private\n * Governs the logic for inviting N users to a single group.\n * An individual invite call goes out for each user and the results are consolidated.\n * See comment in function about the for...of loop which explains reasoning.\n *\n * @export\n * @param {IAddOrInviteContext} context context object\n * @param {string} userType what type of user is it: org | world | community\n * @return {IAddOrInviteResponse} response object\n */\nexport function processInviteUsers(context, userType) {\n    return __awaiter(this, void 0, void 0, function () {\n        var users, notInvited, errors, addUserAsGroupAdmin, _i, users_1, user, inviteResponse;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    users = getProp(context, userType);\n                    notInvited = [];\n                    errors = [];\n                    addUserAsGroupAdmin = context.addUserAsGroupAdmin;\n                    _i = 0, users_1 = users;\n                    _a.label = 1;\n                case 1:\n                    if (!(_i < users_1.length)) return [3 /*break*/, 4];\n                    user = users_1[_i];\n                    return [4 /*yield*/, inviteUsers(getProp(context, \"groupId\"), [user], getProp(context, \"primaryRO\"), 20160, // timeout\n                        addUserAsGroupAdmin ? \"group_admin\" : \"group_member\" // if we are in a core team we want to invite them as a group admin, otherwise a group member\n                        )];\n                case 2:\n                    inviteResponse = _a.sent();\n                    // If it's just a failed invite then\n                    // add username to notInvited array\n                    if (!inviteResponse.success) {\n                        notInvited.push(user.username);\n                        // If there was a legit error\n                        // Then only the error returns from\n                        // online. Add error AND include username in notInvited array.\n                        if (inviteResponse.errors) {\n                            errors = errors.concat(inviteResponse.errors);\n                        }\n                    }\n                    _a.label = 3;\n                case 3:\n                    _i++;\n                    return [3 /*break*/, 1];\n                case 4: \n                // if you leave out any of the props\n                // from the final object and you are concatting together arrays you can concat\n                // an undeifined inside an array which will throw off array lengths.\n                return [2 /*return*/, {\n                        users: users.map(function (u) { return u.username; }),\n                        notInvited: notInvited,\n                        errors: errors,\n                        notEmailed: [],\n                        notAdded: [],\n                    }];\n            }\n        });\n    });\n}\n//# sourceMappingURL=process-invite-users.js.map","import { __awaiter, __generator } from \"tslib\";\nimport { handleNoUsers } from \"./handle-no-users\";\nimport { processAutoAddUsers } from \"./process-auto-add-users\";\nimport { processInviteUsers } from \"./process-invite-users\";\n/**\n * @private\n * Handles add/invite logic for community users\n * It returns either an empty instance of the addOrInviteResponse\n * object, or either ther esponse from processing auto adding\n * users or inviting users. If an email has been passed in it also notifies\n * processAutoAddUsers that emails should be sent.\n *\n * @export\n * @param {IAddOrInviteContext} context context object\n * @return {IAddOrInviteResponse} response object\n */\nexport function addOrInviteCommunityUsers(context) {\n    return __awaiter(this, void 0, void 0, function () {\n        var fnToCall, shouldEmail;\n        return __generator(this, function (_a) {\n            fnToCall = handleNoUsers;\n            shouldEmail = false;\n            // If community users were passed in...\n            if (context.community && context.community.length > 0) {\n                // Default to either autoAdd or invite based on canAutoAddUser.\n                fnToCall = context.canAutoAddUser\n                    ? processAutoAddUsers\n                    : processInviteUsers;\n                // If we have an email object\n                // Then we will auto add...\n                // But whether or not we email is still in question\n                if (context.email) {\n                    // If the email object has the groupId property...\n                    if (context.email.hasOwnProperty(\"groupId\")) {\n                        // If the email objects groupId property is the same as the current groupId in context...\n                        // (This function is part of a flow that could work for N groupIds)\n                        if (context.email.groupId === context.groupId) {\n                            // Then we auto add and send email\n                            fnToCall = processAutoAddUsers;\n                            shouldEmail = true;\n                        } // ELSE if the groupId's do NOT match, we will fall back\n                        // To autoAdd or invite as per line 32.\n                        // We are doing the above logic (lines 43 - 47) because\n                        // We wish to add users to core teams, followers, and content teams\n                        // but only to email the core team.\n                    }\n                    else {\n                        // If it does not have a groupId at all then we will autoAdd and email.\n                        fnToCall = processAutoAddUsers;\n                        shouldEmail = true;\n                    }\n                }\n            }\n            // Return/call the function\n            return [2 /*return*/, fnToCall(context, \"community\", shouldEmail)];\n        });\n    });\n}\n//# sourceMappingURL=add-or-invite-community-users.js.map","import { __awaiter, __generator } from \"tslib\";\nimport { handleNoUsers } from \"./handle-no-users\";\nimport { processAutoAddUsers } from \"./process-auto-add-users\";\nimport { processInviteUsers } from \"./process-invite-users\";\n/**\n * @private\n * Handles add/invite logic for Org users\n * It returns either an empty instance of the addOrInviteResponse\n * object, or either ther esponse from processing auto adding a users or inviting a user\n *\n * @export\n * @param {IAddOrInviteContext} context context object\n * @return {IAddOrInviteResponse} response object\n */\nexport function addOrInviteOrgUsers(context) {\n    return __awaiter(this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            // If there are no org users return handling no users\n            if (!context.org || context.org.length === 0) {\n                // we return an empty object because\n                // if you leave out any of the props\n                // from the final object and you are concatting together arrays you can concat\n                // an undeifined inside an array which will throw off array lengths.\n                return [2 /*return*/, handleNoUsers()];\n            }\n            // for org user if you have assignUsers then auto add the user\n            // if not then invite the user\n            return [2 /*return*/, context.canAutoAddUser\n                    ? processAutoAddUsers(context, \"org\")\n                    : processInviteUsers(context, \"org\")];\n        });\n    });\n}\n//# sourceMappingURL=add-or-invite-org-users.js.map","import { __awaiter, __generator } from \"tslib\";\nimport { handleNoUsers } from \"./handle-no-users\";\nimport { processInviteUsers } from \"./process-invite-users\";\n/**\n * @private\n * Handles add/invite logic for world users\n * It either returns an empty instance of the add/invite response\n * object, or a populated version from processInviteUsers\n *\n * @export\n * @param {IAddOrInviteContext} context Context object\n * @return {IAddOrInviteResponse} Response object\n */\nexport function addOrInviteWorldUsers(context) {\n    return __awaiter(this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            // If there are no world users return handling no users\n            if (!context.world || context.world.length === 0) {\n                // we return an empty object because\n                // if you leave out any of the props\n                // from the final object and you are concatting together arrays you can concat\n                // an undeifined inside an array which will throw off array lengths.\n                return [2 /*return*/, handleNoUsers()];\n            }\n            // process invite\n            return [2 /*return*/, processInviteUsers(context, \"world\")];\n        });\n    });\n}\n//# sourceMappingURL=add-or-invite-world-users.js.map","import { __awaiter, __generator } from \"tslib\";\nimport { handleNoUsers } from \"./handle-no-users\";\nimport { processInviteUsers } from \"./process-invite-users\";\n/**\n * @private\n * Handles add/invite logic for partnered org users.\n * It returns either an empty instance of the addOrInviteResponse\n * object, or their response from inviting users.\n *\n * @export\n * @param {IAddOrInviteContext} context context object\n * @return {IAddOrInviteResponse} response object\n */\nexport function addOrInvitePartneredUsers(context) {\n    return __awaiter(this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            // If there are no org users return handling no users\n            if (!context.partnered || context.partnered.length === 0) {\n                // we return an empty object because\n                // if you leave out any of the props\n                // from the final object and you are concatting together arrays you can concat\n                // an undeifined inside an array which will throw off array lengths.\n                return [2 /*return*/, handleNoUsers()];\n            }\n            // process invite\n            return [2 /*return*/, processInviteUsers(context, \"partnered\")];\n        });\n    });\n}\n//# sourceMappingURL=add-or-invite-partnered-users.js.map","import { __awaiter, __generator } from \"tslib\";\nimport { handleNoUsers } from \"./handle-no-users\";\nimport { processAutoAddUsers } from \"./process-auto-add-users\";\n/**\n * @private\n * Handles add/invite logic for collaboration coordinators inside partnered orgs.\n * This is intentionally split out from the invitation of partnered org normal members,\n * because the two types of partnered org usres (regular and collaboration coordinator)\n * always come from the same 'bucket', however have distinctly different add paths Invite vs auto add.\n * It returns either an empty instance of the addOrInviteResponse\n * object, or their response from auto adding users.\n *\n * @export\n * @param {IAddOrInviteContext} context context object\n * @return {IAddOrInviteResponse} response object\n */\nexport function addOrInviteCollaborationCoordinators(context) {\n    return __awaiter(this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            // If there are no org users return handling no users\n            if (!context.collaborationCoordinator ||\n                context.collaborationCoordinator.length === 0) {\n                // we return an empty object because\n                // if you leave out any of the props\n                // from the final object and you are concatting together arrays you can concat\n                // an undeifined inside an array which will throw off array lengths.\n                return [2 /*return*/, handleNoUsers()];\n            }\n            return [2 /*return*/, processAutoAddUsers(context, \"collaborationCoordinator\")];\n        });\n    });\n}\n//# sourceMappingURL=add-or-invite-collaboration-coordinators.js.map","/**\n * @private\n * Takes users array and sorts them into an object by the type of user they are\n * based on the orgType prop (world|org|community)\n *\n * @export\n * @param {IUserWithOrgType[]} users array of users\n * @return {IUserOrgRelationship} Object of users sorted by type (world, org, community)\n */\nexport function groupUsersByOrgRelationship(users) {\n    return users.reduce(function (acc, user) {\n        // keyof needed to make bracket notation work without TS throwing a wobbly.\n        var orgType = user.orgType;\n        acc[orgType].push(user);\n        return acc;\n    }, {\n        world: [],\n        org: [],\n        community: [],\n        partnered: [],\n        collaborationCoordinator: [],\n    });\n}\n//# sourceMappingURL=group-users-by-org-relationship.js.map","import { __awaiter, __generator, __spreadArrays } from \"tslib\";\nimport { addOrInviteCommunityUsers, addOrInviteOrgUsers, addOrInviteWorldUsers, addOrInvitePartneredUsers, addOrInviteCollaborationCoordinators, groupUsersByOrgRelationship, } from \"./utils\";\n/**\n * Add or invite N users to a single team\n * Org|community|world logic flows are run even if there are no users applicable for that particular path.\n * Results from each path are consolidated and surfaced in the return object as failures and errors are of\n * more importance than successes.\n *\n * @export\n * @param {string} groupId Group we are adding users to\n * @param {IUserWithOrgType[]} users array of users to add\n * @param {IAuthenticationManager} primaryRO primary requestOptions\n * @param {boolean} canAutoAddUser Can we automatically add a user to the team?\n * @param {boolean} addUserAsGroupAdmin Should the user be added as a group administrator\n * @param {IAddOrInviteEmail} email Email object\n * @return {IAddOrInviteToTeamResult} Result object\n */\nexport function addOrInviteUsersToTeam(groupId, users, primaryRO, canAutoAddUser, addUserAsGroupAdmin, email) {\n    return __awaiter(this, void 0, void 0, function () {\n        var parsedUsers, inputParams, context, result, _a;\n        return __generator(this, function (_b) {\n            switch (_b.label) {\n                case 0:\n                    parsedUsers = groupUsersByOrgRelationship(users);\n                    inputParams = {\n                        groupId: groupId,\n                        primaryRO: primaryRO,\n                        allUsers: users,\n                        canAutoAddUser: canAutoAddUser,\n                        addUserAsGroupAdmin: addUserAsGroupAdmin,\n                        email: email,\n                    };\n                    context = Object.assign(inputParams, parsedUsers);\n                    _a = {};\n                    return [4 /*yield*/, addOrInviteCommunityUsers(context)];\n                case 1:\n                    _a.community = _b.sent();\n                    return [4 /*yield*/, addOrInviteOrgUsers(context)];\n                case 2:\n                    _a.org = _b.sent();\n                    return [4 /*yield*/, addOrInviteWorldUsers(context)];\n                case 3:\n                    _a.world = _b.sent();\n                    return [4 /*yield*/, addOrInvitePartneredUsers(context)];\n                case 4:\n                    _a.partnered = _b.sent();\n                    return [4 /*yield*/, addOrInviteCollaborationCoordinators(context)];\n                case 5:\n                    result = (_a.collaborationCoordinator = _b.sent(),\n                        _a.notAdded = [],\n                        _a.notInvited = [],\n                        _a.notEmailed = [],\n                        _a.errors = [],\n                        _a.groupId = groupId,\n                        _a);\n                    // Bring not added / invited / emailed / errors up to the top level\n                    result.notAdded = __spreadArrays(result.community.notAdded, result.org.notAdded, result.world.notAdded);\n                    result.notInvited = __spreadArrays(result.community.notInvited, result.org.notInvited, result.world.notInvited);\n                    result.notEmailed = __spreadArrays(result.community.notEmailed, result.org.notEmailed, result.world.notEmailed);\n                    result.errors = __spreadArrays(result.community.errors, result.org.errors, result.world.errors);\n                    return [2 /*return*/, result];\n            }\n        });\n    });\n}\n//# sourceMappingURL=add-or-invite-users-to-team.js.map","import { __awaiter, __generator } from \"tslib\";\nimport { removeGroupUsers, } from \"@esri/arcgis-rest-portal\";\n/**\n * Remove N users from team. Acts as a wrapper around removeGroupUsers from arcgis-rest-portal\n *\n * @export\n * @param {string} id Group Id\n * @param {string[]} users Array of usernames to remove\n * @param {IAuthenticationManager} authentication auth\n * @return {*}  {Promise<IRemoveGroupUsersResult>}\n */\nexport function removeUsersFromTeam(id, users, authentication) {\n    return __awaiter(this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            return [2 /*return*/, removeGroupUsers({\n                    id: id,\n                    users: users,\n                    authentication: authentication,\n                })];\n        });\n    });\n}\n//# sourceMappingURL=remove-users-from-team.js.map","import { searchGroups, } from \"@esri/arcgis-rest-portal\";\n/**\n * Search for teams\n * @param {ISearchOptions} searchRequestOptions\n * @returns {Promise<ISearchResult>}\n * @private\n */\nexport function _searchTeams(searchRequestOptions) {\n    return searchGroups(searchRequestOptions);\n}\n//# sourceMappingURL=_search-teams.js.map","import { __awaiter, __generator } from \"tslib\";\nimport { addOrInviteUsersToTeam } from \"./add-or-invite-users-to-team\";\n/**\n * addOrInviteUsersToTeams adds/invites N users to N teams\n * Initial entry point function for add/invite members flow\n * when dealing with multiple teams.\n * Responses from each group are then consolidated into the final returned object.\n *\n * @export\n * @param {string[]} groupIds array of groups we are adding users to\n * @param {IUserWithOrgType[]} users array of users to add to those teams\n * @param {IAuthenticationManager} primaryRO primary requestOptions\n * @param {boolean} [canAutoAddUser=false] Can we automatically add a user to the team?\n * @param {boolean} [addUserAsGroupAdmin=false] Can the user be added to a team as an administrator of that team?\n * @param {IAddOrInviteEmail} [email] Email object contains auth for the email && the email object itself\n * @return {*}  {Promise<{\n *   notAdded: string[];\n *   notInvited: string[];\n *   notEmailed: string[];\n *   errors: ArcGISRequestError[];\n *   responses: IAddOrInviteToTeamResult[];\n * }>} Results object\n */\nexport function addOrInviteUsersToTeams(groupIds, users, primaryRO, canAutoAddUser, addUserAsGroupAdmin, email) {\n    if (canAutoAddUser === void 0) { canAutoAddUser = false; }\n    if (addUserAsGroupAdmin === void 0) { addUserAsGroupAdmin = false; }\n    return __awaiter(this, void 0, void 0, function () {\n        var notAdded, notInvited, notEmailed, errors, responses, _i, groupIds_1, groupId, result;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    notAdded = [];\n                    notInvited = [];\n                    notEmailed = [];\n                    errors = [];\n                    responses = [];\n                    _i = 0, groupIds_1 = groupIds;\n                    _a.label = 1;\n                case 1:\n                    if (!(_i < groupIds_1.length)) return [3 /*break*/, 4];\n                    groupId = groupIds_1[_i];\n                    return [4 /*yield*/, addOrInviteUsersToTeam(groupId, users, primaryRO, canAutoAddUser, addUserAsGroupAdmin, email)];\n                case 2:\n                    result = _a.sent();\n                    // attach each groups results\n                    responses.push(result);\n                    // surface results to the top of the stack...\n                    notAdded = notAdded.concat(result.notAdded);\n                    errors = errors.concat(result.errors);\n                    notInvited = notInvited.concat(result.notInvited);\n                    notEmailed = notEmailed.concat(result.notEmailed);\n                    _a.label = 3;\n                case 3:\n                    _i++;\n                    return [3 /*break*/, 1];\n                case 4: \n                // Return built up result object.\n                return [2 /*return*/, {\n                        notAdded: notAdded,\n                        notInvited: notInvited,\n                        notEmailed: notEmailed,\n                        errors: errors,\n                        responses: responses,\n                    }];\n            }\n        });\n    });\n}\n//# sourceMappingURL=add-or-invite-users-to-teams.js.map","import { addUsersToGroup } from \"@esri/hub-common\";\n/**\n * Attempts to Add, Invite, or email users about joining\n * a team depending on the requesting user's permissions\n * (see addUsersToGroup in hub-common)\n *\n * @param {string} groupId\n * @param {IUser[]} usersToAdd\n * @param {IHubRequestOptions} primaryRO Info and authentication for the requesting user\n * @param {IEmail} [email] Email to be sent (if qualifying users are passed in)\n * @param {IHubRequestOptions} [secondaryRO] Info and authentication for emailing members of a secondary organization (typically a community org)\n *\n * @returns {IConsolidatedResult} The operations attempted, whether they were successful and any errors\n */\nexport function addUsersToTeam(teamId, usersToAdd, primaryRO, email, secondaryRO) {\n    return addUsersToGroup(teamId, usersToAdd, primaryRO, email, secondaryRO);\n}\n//# sourceMappingURL=add-users-to-team.js.map","/**\n * Checks if user has access to edit a team\n * @param {IGroup} group\n * @param {IUser} user\n * @returns {boolean}\n */\nexport function canEditTeam(group, user) {\n    var _a, _b;\n    var memberType = (_a = group.userMembership) === null || _a === void 0 ? void 0 : _a.memberType;\n    var userName = (_b = group.userMembership) === null || _b === void 0 ? void 0 : _b.username;\n    return (userName === user.username &&\n        (memberType === \"owner\" || memberType === \"admin\"));\n}\n//# sourceMappingURL=can-edit-team.js.map","import { TEAMTYPES } from \"./types\";\nimport { getHubProduct, getCulture, convertToWellKnownLocale, fetchHubTranslation, getSubscriptionType, } from \"@esri/hub-common\";\nimport { getUserCreatableTeams } from \"./utils/get-user-creatable-teams\";\nimport { _createTeamGroups } from \"./utils/_create-team-groups\";\n/**\n * Create a single Team, using the same logic as creating multiple Teams.\n * Also allows a set of custom props to be passed in and applied to the team.\n *\n * This should be used PRIOR to creating Sites/Initiatives.\n * @param {ICreateHubTeamOptions} createHubTeamOptions\n */\nexport function createHubTeam(opts) {\n    var title = opts.title, type = opts.type, props = opts.props, hubRequestOptions = opts.hubRequestOptions;\n    // validate that the type is valid...\n    if (TEAMTYPES.indexOf(type) === -1) {\n        throw new Error(\"createHubTeam was passed \" + type + \" which is not a valid type of team. Please send one of: \" + TEAMTYPES.join(\",\"));\n    }\n    // get all the groups the current user can create...\n    // filter just the ones that match type...\n    var portalSelf = hubRequestOptions.portalSelf;\n    var product = getHubProduct(portalSelf);\n    var subscriptionType = getSubscriptionType(portalSelf);\n    var groupsToCreate = getUserCreatableTeams(portalSelf.user, product, portalSelf.currentVersion, subscriptionType)\n        .filter(function (g) {\n        return g.config.type === type;\n    })\n        .map(function (grp) {\n        // If props are passed in, spread them over the group object, but only if type === `team`\n        if (grp.config.type === \"team\") {\n            return Object.assign({}, grp, props);\n        }\n        else {\n            return grp;\n        }\n    });\n    // use the locale of the current user, or en-us as a fall-back\n    var culture = getCulture(hubRequestOptions);\n    var locale = convertToWellKnownLocale(culture);\n    // Fire that off\n    return fetchHubTranslation(locale, hubRequestOptions.portalSelf)\n        .then(function (translations) {\n        // delegate to createTeamGroups\n        return _createTeamGroups(title, groupsToCreate, translations, hubRequestOptions);\n    })\n        .catch(function (ex) {\n        throw Error(\"Error in team-utils::createHubTeam \" + ex);\n    });\n}\n//# sourceMappingURL=create-hub-team.js.map","import { getHubProduct, getCulture, convertToWellKnownLocale, fetchHubTranslation, getSubscriptionType, } from \"@esri/hub-common\";\nimport { getUserCreatableTeams } from \"./utils/get-user-creatable-teams\";\nimport { _createTeamGroups } from \"./utils/_create-team-groups\";\n/**\n * Create all the groups (aka Teams) required for a Site or Initiative\n * The group names are derived from the Site/Initiative title. Group names\n * must be unique on create, so if necessary we will increment the names\n * after translation. If you need to ADD a Team to an existing Site/Initiative,\n * use the teams-service::addTeams function\n * @param {ICreateHubTeamsOptions} createHubTeamsOptions\n */\nexport function createHubTeams(opts) {\n    var title = opts.title, types = opts.types, hubRequestOptions = opts.hubRequestOptions;\n    var product = getHubProduct(hubRequestOptions.portalSelf);\n    // get all the groups that this user can create in this environment\n    // and filter just the team types requested\n    var subscriptionType = getSubscriptionType(hubRequestOptions.portalSelf);\n    var teamsToCreate = getUserCreatableTeams(hubRequestOptions.portalSelf.user, product, hubRequestOptions.portalSelf.currentVersion, subscriptionType).filter(function (g) {\n        return types.indexOf(g.config.type) > -1;\n    });\n    // get the culture out of the\n    var culture = getCulture(hubRequestOptions);\n    var locale = convertToWellKnownLocale(culture);\n    // Fire that off\n    return fetchHubTranslation(locale, hubRequestOptions.portalSelf)\n        .then(function (translations) {\n        // create the team groups\n        return _createTeamGroups(title, teamsToCreate, translations, hubRequestOptions);\n    })\n        .catch(function (ex) {\n        throw Error(\"Error in team-utils::createHubTeams \" + ex);\n    });\n}\n//# sourceMappingURL=create-hub-teams.js.map","import { getGroupUsers } from \"@esri/arcgis-rest-portal\";\n/**\n * Get the users(usernames ONLY) that are members of the Group that backs the Team\n * @param {string} id group id\n * @param {IRequestOptions} hubRequestOptions\n * @returns {Promise<IGroupUsersResult>}\n */\nexport function getTeamMembers(id, hubRequestOptions) {\n    return getGroupUsers(id, hubRequestOptions);\n}\n//# sourceMappingURL=get-team-members.js.map","/**\n * Return a map from the team names to the property names\n * @param {string} product Product Name (basic, premium, enterprise)\n */\nexport function getTeamPropertiesMapForProduct(product) {\n    // basic and enterprise, it's just the content group\n    var map = {\n        content: \"contentGroupId\",\n        core: \"collaborationGroupId\"\n    };\n    // premium, we add core and followers\n    if (product === \"premium\") {\n        map.followers = \"followersGroupId\";\n    }\n    return map;\n}\n//# sourceMappingURL=get-team-properties-map-for-product.js.map","import { __awaiter, __generator } from \"tslib\";\nimport { getProp } from \"@esri/hub-common\";\nimport { getTeamById } from \"./get-team-by-id\";\nimport { canUserCreateTeam } from \"./can-user-create-team\";\nimport { TYPEMAP } from \"./type-map\";\n/**\n * Given an item, a teamType and a user, return the status\n * of the team ('ok', 'missing', 'broken', 'fixable' ), along\n * with specific details:\n * id: id of the group\n * isMissing: was the group simply never created?\n * isBroken: true if the item has an id for the group, but the group can not be found\n * canFix: true if user can create the group\n * If a team that a route depends on returns `isBroken` the route should redirect\n * to /teams/repair, which will do a full inspection, list things that are broken\n * and then conduct any repairs that can be done. It will list the issues, with\n * the intent of training customers to NOT mess with Team groups in AGO.\n * Once repairs are complete, the user will click a button to return to the route they\n * we attempting to enter before this diversion.\n *\n * @export\n * @param {IItem} item Site or Initiative ITEM (not model)\n * @param {(\"core\" | \"content\" | \"followers\")} teamType Type of team to check for\n * @param {IUser} user User Object\n * @param {IHubRequestOptions} ro Auth\n * @return {*}  {Promise<ITeamStatus>}\n */\nexport function getTeamStatus(item, teamType, user, ro) {\n    return __awaiter(this, void 0, void 0, function () {\n        var result, id, group, _a, ex_1, _b, _c;\n        return __generator(this, function (_d) {\n            switch (_d.label) {\n                case 0:\n                    result = {\n                        teamType: teamType,\n                        id: null,\n                        isOk: false,\n                        isMissing: true,\n                        isBroken: false,\n                        canFix: false,\n                        isMember: false,\n                    };\n                    id = getProp(getProp(item, \"properties\"), TYPEMAP[teamType]);\n                    if (!id) return [3 /*break*/, 9];\n                    _d.label = 1;\n                case 1:\n                    _d.trys.push([1, 6, , 8]);\n                    return [4 /*yield*/, getTeamById(id, ro)];\n                case 2:\n                    group = _d.sent();\n                    if (!group) return [3 /*break*/, 3];\n                    result.id = id;\n                    result.isOk = true;\n                    result.isMissing = false;\n                    return [3 /*break*/, 5];\n                case 3:\n                    // If it doesn't, then check to see if user can Create team\n                    result.id = id;\n                    result.isBroken = true;\n                    _a = result;\n                    return [4 /*yield*/, canUserCreateTeam(user, teamType, ro)];\n                case 4:\n                    _a.canFix = _d.sent();\n                    _d.label = 5;\n                case 5: return [3 /*break*/, 8];\n                case 6:\n                    ex_1 = _d.sent();\n                    // If the search errors then check if user can create team\n                    result.id = id;\n                    result.isBroken = true;\n                    _b = result;\n                    return [4 /*yield*/, canUserCreateTeam(user, teamType, ro)];\n                case 7:\n                    _b.canFix = _d.sent();\n                    return [3 /*break*/, 8];\n                case 8: return [3 /*break*/, 11];\n                case 9:\n                    // If there is not an id then check if the user can create the team\n                    _c = result;\n                    return [4 /*yield*/, canUserCreateTeam(user, teamType, ro)];\n                case 10:\n                    // If there is not an id then check if the user can create the team\n                    _c.canFix = _d.sent();\n                    _d.label = 11;\n                case 11: return [2 /*return*/, result];\n            }\n        });\n    });\n}\n//# sourceMappingURL=get-team-status.js.map","import { getTeamsAvailableInProduct } from \"./get-teams-available-in-product\";\n/**\n * Get the template for a team. This should be used sparingly,\n * usually when you need some of the default properties of the\n * group, but in a context outside of the normal team-service functions.\n * @param {string} team core \\ content | followers | team\n * @param {string} product basic | premium | portal\n * @param {string} portalApiVersion portal version\n */\nexport function getTeamTemplate(type, product, portalApiVersion) {\n    return getTeamsAvailableInProduct(product, portalApiVersion).find(function (t) {\n        return t.config.type === type;\n    });\n}\n//# sourceMappingURL=get-team-template.js.map","import { getTeamsAvailableInProduct } from \"./get-teams-available-in-product\";\n/**\n * Get the types of teams that can be created given the product\n * @param {string} product Product name portal | basic | premium\n */\nexport function getTeamTypesAvailableInProduct(product, portalApiVersion) {\n    return getTeamsAvailableInProduct(product, portalApiVersion).map(function (team) {\n        return team.config.type;\n    });\n}\n//# sourceMappingURL=get-team-types-available-in-product.js.map","export function getTeamsForProduct(product) {\n    var teams = [\"content\", \"core\"];\n    if (product === \"premium\") {\n        teams.push(\"followers\");\n    }\n    return teams;\n}\n//# sourceMappingURL=get-teams-for-product.js.map","import { __awaiter, __generator } from \"tslib\";\nimport { removeGroup, unprotectGroup } from \"@esri/arcgis-rest-portal\";\n/**\n * removeTeam unprotects a group, then deletes it\n *\n * @export\n * @param {string} id Team Id\n * @param {UserSession} authentication authentication\n * @return {*}  {Promise<{groupId: string; success: boolean}>}\n */\nexport function removeTeam(id, authentication) {\n    return __awaiter(this, void 0, void 0, function () {\n        var unprotectResult;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4 /*yield*/, unprotectGroup({ id: id, authentication: authentication })];\n                case 1:\n                    unprotectResult = _a.sent();\n                    // If that succeeded...\n                    return [2 /*return*/, unprotectResult.success\n                            // Remove it.\n                            ? removeGroup({ id: id, authentication: authentication })\n                            // Otherwise return a fail state\n                            : { groupId: id, success: false }];\n            }\n        });\n    });\n}\n//# sourceMappingURL=remove-team.js.map","/* Copyright (c) 2017-2018 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\nimport { __assign } from \"tslib\";\nimport { request } from \"@esri/arcgis-rest-request\";\nimport { getPortalUrl } from \"../util/get-portal-url\";\n/**\n * ```js\n * import { removeGroup } from '@esri/arcgis-rest-portal';\n * //\n * removeGroup({\n *   id: groupId,\n *   authentication\n * })\n *   .then(response)\n * ```\n * Delete a group. See the [REST Documentation](https://developers.arcgis.com/rest/users-groups-and-items/delete-group.htm) for more information.\n *\n * @param requestOptions - Options for the request\n * @returns A Promise that will resolve with the success/failure status of the request\n */\nexport function removeGroup(requestOptions) {\n    var url = getPortalUrl(requestOptions) + \"/community/groups/\" + requestOptions.id + \"/delete\";\n    var options = __assign({}, requestOptions);\n    return request(url, options);\n}\n//# sourceMappingURL=remove.js.map","import { __awaiter, __generator } from \"tslib\";\nimport { updateItem } from \"@esri/arcgis-rest-portal\";\nimport { cloneObject, without } from \"@esri/hub-common\";\n/**\n * Removes a Team from N hub models.\n * First, if passed deleteTeam, it will delete the team\n * Then it iterates over an array of IModels and removes the given team ID from their teams array\n *\n * @export\n * @param {string} teamId Team ID of the team we are removing\n * @param {IModel[]} models Array of IModels\n * @param {UserSession} authentication Auth\n * @return {*}  {Promise<IUpdateItemResponse[]>}\n */\nexport function removeTeamFromItems(teamId, models, authentication) {\n    return __awaiter(this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            // Iterate over all items...\n            return [2 /*return*/, Promise.all(models.map(function (model) {\n                    // clone the item before modifying\n                    var clonedModel = cloneObject(model);\n                    // remove the id from the item.properties.teams array\n                    clonedModel.item.properties.teams = without(clonedModel.item.properties.teams, teamId);\n                    // Check if the user has access to edit the item. itemControl is only present when the item is directly fetched\n                    // \n                    return clonedModel.item.itemControl === \"admin\" || clonedModel.item.itemControl === \"update\"\n                        // If yes, then update the item\n                        ? updateItem({\n                            item: clonedModel.item,\n                            authentication: authentication,\n                        })\n                        // Otherwise return a 'fail' state for that item specifically\n                        : { id: clonedModel.item.id, success: false };\n                }))];\n        });\n    });\n}\n//# sourceMappingURL=remove-team-from-items.js.map","import { __awaiter, __generator } from \"tslib\";\nimport { removeUsersFromTeam } from \"./remove-users-from-team\";\n/**\n * Removes N users from N teams. Calls removeUsersFromTeam on each of the N teams\n *\n * @export\n * @param {string[]} teamIds Array of team ids\n * @param {string[]} usernames Array of usernames to remove\n * @param {IAuthenticationManager} ro Auth\n * @return {*}  {Promise<IRemoveGroupUsersResult[]>}\n */\nexport function removeUsersFromTeams(teamIds, usernames, ro) {\n    return __awaiter(this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            return [2 /*return*/, Promise.all(teamIds.map(function (id) { return removeUsersFromTeam(id, usernames, ro); }))];\n        });\n    });\n}\n//# sourceMappingURL=remove-users-from-teams.js.map","import { searchGroupContent } from \"@esri/arcgis-rest-portal\";\n/**\n * Get the content of a team\n * @param {ISearchGroupContentOptions} searchOptions\n * @returns {Promise<ISearchResult<IItem>>}\n */\nexport function searchTeamContent(searchOptions) {\n    return searchGroupContent(searchOptions);\n}\n//# sourceMappingURL=search-team-content.js.map","import { searchGroupUsers } from \"@esri/arcgis-rest-portal\";\n/**\n * Get the users(actual USER OBJECTS) that are members of the Group that backs the Team\n * @param {string} id group id\n * @param {ISearchGroupUsersOptions} searchOptions\n * @returns {Promise<ISearchGroupUsersResult>}\n */\nexport function searchTeamMembers(id, searchOptions) {\n    return searchGroupUsers(id, searchOptions);\n}\n//# sourceMappingURL=search-team-members.js.map","/**\n * Takes array of group ids, if it is a core team, and teams status\n * and returns array of groups\n *\n * @param {array} groupIds Array of group ids\n * @param {boolean} isCoreTeam is this a core team?\n * @param {ITeamsStatus} teamsStatus status of main teams associated with site (core, content, followers)\n */\nexport function teamsToAddUsersTo(groupIds, isCoreTeam, teamsStatus) {\n    // If it's a core team && we have the teamsStatus\n    if (isCoreTeam && teamsStatus) {\n        // Array<keyof etc is needed due to bracket notation to prevent TS from throwing a wobbly\n        [\"content\", \"followers\"].forEach(function (teamProp) {\n            if (teamsStatus[teamProp] && teamsStatus[teamProp].isOk) {\n                groupIds.push(teamsStatus[teamProp].id);\n            }\n        });\n    }\n    return groupIds;\n}\n//# sourceMappingURL=teams-to-add-users-to.js.map","import { __awaiter, __generator } from \"tslib\";\nimport { updateGroup } from \"@esri/arcgis-rest-portal\";\n/**\n * Updates a group. Wrapper around updateGroup from arcgis-rest-portal\n *\n * @export\n * @param {IGroup} group Group object that's being updated\n * @param {IAuthenticationManager} authentication Auth\n * @return {*}  {Promise<{ success: boolean; groupId: string }>}\n */\nexport function updateTeam(group, authentication) {\n    return __awaiter(this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            return [2 /*return*/, updateGroup({ group: group, authentication: authentication })];\n        });\n    });\n}\n//# sourceMappingURL=update-team.js.map","/* Copyright (c) 2017-2018 Environmental Systems Research Institute, Inc.\n * Apache-2.0 */\nimport { __assign } from \"tslib\";\nimport { request } from \"@esri/arcgis-rest-request\";\nimport { getPortalUrl } from \"../util/get-portal-url\";\n/**\n * ```js\n * import { updateGroup } from '@esri/arcgis-rest-portal';\n * //\n * updateGroup({\n *   group: { id: \"fgr344\", title: \"new\" }\n * })\n *   .then(response)\n * ```\n * Update the properties of a group. See the [REST Documentation](https://developers.arcgis.com/rest/users-groups-and-items/update-group.htm) for more information.\n *\n * @param requestOptions - Options for the request, including the group\n * @returns A Promise that will resolve with the success/failure status of the request\n */\nexport function updateGroup(requestOptions) {\n    var url = getPortalUrl(requestOptions) + \"/community/groups/\" + requestOptions.group.id + \"/update\";\n    requestOptions.params = __assign(__assign({}, requestOptions.params), requestOptions.group);\n    return request(url, requestOptions);\n}\n//# sourceMappingURL=update.js.map","import { __awaiter, __generator } from \"tslib\";\nimport { updateUserMemberships, } from \"@esri/arcgis-rest-portal\";\n/**\n * Updates users membership to admin or member, acts as a wrapper for updateUserMemberships from arcgis-rest-portal\n *\n * @export\n * @param {string} id Group id that the members belong to\n * @param {string[]} users Array of usernames to update membership level on\n * @param {(\"member\" | \"admin\")} newMemberType The type of user to update the users to\n * @param {UserSession} authentication authentication\n * @return {*}  {Promise<IUpdateGroupUsersResult>}\n */\nexport function updateUserMembership(id, users, newMemberType, authentication) {\n    return __awaiter(this, void 0, void 0, function () {\n        return __generator(this, function (_a) {\n            return [2 /*return*/, updateUserMemberships({\n                    id: id,\n                    users: users,\n                    newMemberType: newMemberType,\n                    authentication: authentication,\n                })];\n        });\n    });\n}\n//# sourceMappingURL=update-user-membership.js.map","import { getPortalUrl } from \"../util/get-portal-url\";\nimport { request } from \"@esri/arcgis-rest-request\";\n/**\n * ```js\n * import { updateUserMemberships } from \"@esri/arcgis-rest-portal\";\n * //\n * updateUserMemberships({\n *   id: groupId,\n *   admins: [\"username3\"],\n *   authentication\n * })\n * .then(response);\n * ```\n * Change the user membership levels of existing users in a group\n *\n * @param requestOptions  - Options for the request\n * @returns A Promise\n */\nexport function updateUserMemberships(requestOptions) {\n    var url = getPortalUrl(requestOptions) + \"/community/groups/\" + requestOptions.id + \"/updateUsers\";\n    var opts = {\n        authentication: requestOptions.authentication,\n        params: {}\n    };\n    // add the correct params depending on the type of membership we are changing to\n    if (requestOptions.newMemberType === \"admin\") {\n        opts.params.admins = requestOptions.users;\n    }\n    else {\n        opts.params.users = requestOptions.users;\n    }\n    // make the request\n    return request(url, opts);\n}\n//# sourceMappingURL=update-user-membership.js.map"],"names":["TEAMTYPES","WELLKNOWNTEAMS","config","groupType","type","availableIn","propertyName","requiredPrivs","titleI18n","descriptionI18n","snippetI18n","privPropValues","priv","prop","value","access","autoJoin","isInvitationOnly","isViewOnly","sortField","sortOrder","capabilities","membershipAccess","_edit_privacy","_edit_contributors","tags","notificationsEnabled","typekeyword","hasAllPrivileges","user","privileges","result","Array","isArray","every","indexOf","canUserCreateTeamInProduct","product","template","getProp","length","includes","ALLOWED_SUBSCRIPTION_TYPES","getUserCreatableTeams","environment","portalApiVersion","subscriptionInfoType","console","warn","allowedSubscriptionTypes","teams","updatedUser","clonedUser","cloneObject","without","reduce","acc","teamTmpl","templateCopy","getWithDefault","forEach","entry","copyTemplate","push","_translateTeamTemplate","title","translation","key","i18nKey","targetProp","replace","val","extendStatics","d","b","Object","setPrototypeOf","__proto__","p","hasOwnProperty","__assign","assign","t","s","i","n","arguments","prototype","call","apply","this","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","e","rejected","done","then","__generator","body","f","y","_","label","sent","trys","ops","g","verb","throw","return","Symbol","iterator","v","op","TypeError","pop","__spreadArrays","il","r","k","a","j","jl","requiresFormData","params","keys","some","toParam","constructor","name","processParams","newParams","param","firstElementType","_b","_a","JSON","stringify","join","valueOf","encodeQueryString","map","encodeParam","arrayElem","encodeURIComponent","ArcGISRequestError","message","code","response","url","options","originalMessage","create","Error","_super","NODEJS_DEFAULT_REFERER_HEADER","DEFAULT_ARCGIS_REQUEST_OPTIONS","httpMethod","ArcGISAuthError","__","retry","getSession","retryLimit","retryRequest","_this","session","newOptions","authentication","tries","request","catch","requestOptions","headers","missingGlobals","recommendedPackages","fetch","bind","Function","FormData","rawResponse","originalAuthError","fetchOptions","method","credentials","getToken","err","token","getDomainCredentials","forceFormData","formData_1","requestHeaders","hideToken","window","urlWithQueryString","maxUrlLength","RegExp","test","useFormData","filename","Blob","append","referer","status_1","statusText","ok","status","json","text","blob","data","truncatedUrl","error","messageCode","errorCode","parse","statusMessage","checkForErrors","toLowerCase","split","federatedServers","expires","Date","now","appendCustomParams","customOptions","baseOptions","getPortalUrl","portal","trim","slice","updateItem","owner","item","getUsername","clone","folderId","id","file","SearchQueryBuilder","match","terms","_i","termStack","concat","in","field","hasRange","hasTerms","q","commit","startGroup","openGroups","endGroup","and","addModifier","or","not","from","term","rangeStack","to","boost","num","cleanup","modifier","currentModifer","toUpperCase","needsQuotes","formatTerm","getTime","undefined","defineProperty","get","enumerable","configurable","oldQ","genericSearch","search","searchType","path","groupId","nextStart","nextPage","start","chunk","array","size","chunks","addGroupUsers","admins","users","promises","_prepareRequests","errors","all","_consolidateRequestResults","usernames","results","notAdded","filter","collection","consolidated","removeGroupUsers","usersToRemove","usersChunk","filtered","propName","notRemoved","searchGroups","doesGroupExist","hubRequestOptions","portalSelf","searchResponse","getUniqueGroupTitle","combinedName","GROUP_ACCESS_PRIVS","public","org","private","getAllowedGroupAccess","requestedAccess","canCreatePublic","canCreateOrg","_createTeamGroup","group","uniqueTitle","createResponse","userMembership","username","memberType","applications","ex","_createTeamGroups","groupTemplates","translations","translatedTemplates","tmpl","grpTmpl","groups","props","grp","canUserCreateTeam","hubTeamType","subscriptionType","getHubProduct","getSubscriptionType","currentVersion","getTeamsAvailableInProduct","TYPEMAP","core","content","followers","getTeamById","handleNoUsers","context","userType","shouldEmail","notEmailed","notInvited","autoAddUsersAsAdmins","processEmailUsers","users_1","emailResponse","emailOrgUsers","success","u","processAutoAddUsers","autoAddResponse","addUserAsGroupAdmin","autoAddUsers","processInviteUsers","inviteResponse","inviteUsers","addOrInviteCommunityUsers","fnToCall","community","canAutoAddUser","email","addOrInviteOrgUsers","addOrInviteWorldUsers","world","addOrInvitePartneredUsers","partnered","addOrInviteCollaborationCoordinators","collaborationCoordinator","groupUsersByOrgRelationship","orgType","addOrInviteUsersToTeam","primaryRO","parsedUsers","inputParams","allUsers","removeUsersFromTeam","groupIds","responses","groupIds_1","teamId","usersToAdd","secondaryRO","addUsersToGroup","opts","groupsToCreate","culture","getCulture","locale","convertToWellKnownLocale","fetchHubTranslation","types","teamsToCreate","teamType","ro","_c","_d","isOk","isMissing","isBroken","canFix","isMember","find","team","models","model","clonedModel","properties","itemControl","teamIds","searchOptions","isCoreTeam","teamsStatus","teamProp","newMemberType"],"mappings":"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"}