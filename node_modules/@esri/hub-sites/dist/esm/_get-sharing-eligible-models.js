import { __spreadArrays } from "tslib";
import { getSurveyModels } from "@esri/hub-common";
function _getIneligibleModelIds(siteModel, models, hubRequestOptions) {
    var fetchSurveyModels = function (model) {
        return getSurveyModels(model.item, hubRequestOptions).then(function (_a) {
            var form = _a.form, featureService = _a.featureService, fieldworker = _a.fieldworker, stakeholder = _a.stakeholder;
            return [form, featureService, fieldworker, stakeholder].filter(Boolean);
        });
    };
    var inEligibleModelCollectionPromises = models.reduce(function (acc, model) {
        return model.item.type === "Form" ? __spreadArrays(acc, [fetchSurveyModels(model)]) : acc;
    }, [Promise.resolve([siteModel])]);
    return Promise.all(inEligibleModelCollectionPromises).then(function (ineligibleModelCollections) {
        return ineligibleModelCollections.reduce(function (acc, ineligibleModelCollection) { return __spreadArrays(acc, ineligibleModelCollection); }, []);
    });
}
export function _getSharingEligibleModels(siteModel, models, hubRequestOptions) {
    return _getIneligibleModelIds(siteModel, models, hubRequestOptions).then(function (ineligibleModels) {
        return models.reduce(function (acc, model) {
            return ineligibleModels.find(function (_a) {
                var id = _a.item.id;
                return model.item.id === id;
            })
                ? acc
                : __spreadArrays(acc, [model]);
        }, []);
    });
}
//# sourceMappingURL=_get-sharing-eligible-models.js.map